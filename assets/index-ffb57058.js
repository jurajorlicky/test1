import{r as e,b as s,a as t}from"./vendor-65b1af51.js";import{u as a,L as l,a as r,R as i,b as n,N as c,B as o}from"./router-3a86d15c.js";import{c as d}from"./supabase-354963d4.js";import{G as x}from"./icons-87de0703.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)}).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var m={exports:{}},h={},u=e,p=Symbol.for("react.element"),b=Symbol.for("react.fragment"),f=Object.prototype.hasOwnProperty,j=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,v={key:!0,ref:!0,__self:!0,__source:!0};function g(e,s,t){var a,l={},r=null,i=null;for(a in void 0!==t&&(r=""+t),void 0!==s.key&&(r=""+s.key),void 0!==s.ref&&(i=s.ref),s)f.call(s,a)&&!v.hasOwnProperty(a)&&(l[a]=s[a]);if(e&&e.defaultProps)for(a in s=e.defaultProps)void 0===l[a]&&(l[a]=s[a]);return{$$typeof:p,type:e,key:r,ref:i,props:l,_owner:j.current}}h.Fragment=b,h.jsx=g,h.jsxs=g,m.exports=h;var N=m.exports,w={},y=s;w.createRoot=y.createRoot,w.hydrateRoot=y.hydrateRoot;const k={}.VITE_SUPABASE_URL,_={}.VITE_SUPABASE_ANON_KEY;if(console.log("ENV URL:",k),console.log("ENV KEY:",_),!k||!_)throw new Error("VITE_SUPABASE_URL alebo VITE_SUPABASE_ANON_KEY nie je zadané! Skontroluj nastavenie environment variables v Netlify alebo Vercel.");const C=d(k,_);function z(){const[s,t]=e.useState(""),[l,r]=e.useState(""),[i,n]=e.useState(!1),[c,o]=e.useState(null),[d,x]=e.useState(!1),m=a();return N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100 flex items-center justify-center p-4",children:N.jsx("div",{className:"w-full max-w-md",children:N.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8",children:[N.jsxs("div",{className:"text-center mb-8",children:[N.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-slate-900 to-slate-700 rounded-2xl mb-4",children:N.jsx("img",{src:"https://cdn.myshoptet.com/usr/www.airkicks.eu/user/logos/logo_final-1.png",alt:"Seller Hub Logo",className:"h-10 w-10 object-contain filter brightness-0 invert"})}),N.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Seller Hub"}),N.jsx("p",{className:"text-slate-600 text-sm",children:"Vitajte späť! Prihláste sa do svojho účtu."})]}),N.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0),o(null);try{if(d){const{error:e,data:t}=await C.auth.signUp({email:s,password:l});if(e)throw new Error(`Signup: ${e.message} - ${JSON.stringify(e)}`);m("/dashboard")}else{const{error:e}=await C.auth.signInWithPassword({email:s,password:l});if(e)throw new Error(`SignIn: ${e.message} - ${JSON.stringify(e)}`);m("/dashboard")}}catch(t){console.error("Auth error:",t),o(t.message||JSON.stringify(t))}finally{n(!1)}},className:"space-y-6",children:[N.jsxs("div",{className:"space-y-4",children:[N.jsxs("div",{children:[N.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Email adresa"}),N.jsx("input",{id:"email",type:"email",value:s,onChange:e=>t(e.target.value),className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent transition-all duration-200",placeholder:"vas@email.com",required:!0})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Heslo"}),N.jsx("input",{id:"password",type:"password",value:l,onChange:e=>r(e.target.value),className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent transition-all duration-200",placeholder:"••••••••",required:!0,minLength:6})]})]}),c&&N.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),N.jsx("div",{className:"ml-3",children:N.jsx("p",{className:"text-sm text-red-800",children:c})})]})}),N.jsx("button",{type:"submit",disabled:i,className:"w-full bg-gradient-to-r from-slate-900 to-slate-700 text-white font-semibold py-3 px-4 rounded-xl hover:from-slate-800 hover:to-slate-600 focus:outline-none focus:ring-2 focus:ring-slate-900 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98]",children:i?N.jsxs("div",{className:"flex items-center justify-center",children:[N.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Načítava sa..."]}):d?"Vytvoriť účet":"Prihlásiť sa"}),N.jsx("div",{className:"text-center",children:N.jsx("button",{type:"button",onClick:()=>x(!d),className:"text-sm text-slate-600 hover:text-slate-900 font-medium transition-colors duration-200",children:d?"Už máte účet? Prihláste sa":"Nemáte účet? Zaregistrujte sa"})})]})]})})})}"undefined"!=typeof window&&setTimeout(()=>{(async()=>{try{console.log("Testing Supabase connection...");const{error:e}=await C.from("admin_settings").select("*").limit(1);e?console.warn("Supabase connection test warning:",e.message):console.log("Supabase connection successful")}catch(e){const s=e instanceof Error?e.message:"Unknown connection error";console.warn("Supabase connection test failed:",s)}})().catch(e=>{const s=e instanceof Error?e.message:"Unknown initialization error";console.warn("Failed to initialize Supabase connection test:",s)})},1e3);let S=null,P=0;async function L(){const e=Date.now();if(S&&e-P<3e5)return S;try{const{data:s,error:t}=await C.from("admin_settings").select("fee_percent, fee_fixed").single();if(t)throw t;if(s)return S={fee_percent:s.fee_percent,fee_fixed:s.fee_fixed},P=e,S;const a={fee_percent:.2,fee_fixed:5};return S=a,P=e,a}catch(s){if(console.error("Error fetching admin settings:",s),S)return S;return{fee_percent:.2,fee_fixed:5}}}function M(e,s,t){const a=e*(1-s)-t;return Math.max(0,a)}function E(e){return x({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(e)}function V(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M509.5 184.6L458.9 32.8C452.4 13.2 434.1 0 413.4 0H272v192h238.7c-.4-2.5-.4-5-1.2-7.4zM240 0H98.6c-20.7 0-39 13.2-45.5 32.8L2.5 184.6c-.8 2.4-.8 4.9-1.2 7.4H240V0zM0 224v240c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48V224H0z"},child:[]}]})(e)}function A(e){return x({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 480h-20V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v456H12c-6.627 0-12 5.373-12 12v20h448v-20c0-6.627-5.373-12-12-12zM128 76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76zm0 96c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40zm52 148h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12zm76 160h-64v-84c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v84zm64-172c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40z"},child:[]}]})(e)}function H(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M332.8 320h38.4c6.4 0 12.8-6.4 12.8-12.8V172.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v134.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V76.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v230.4c0 6.4 6.4 12.8 12.8 12.8zm-288 0h38.4c6.4 0 12.8-6.4 12.8-12.8v-70.4c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v70.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V108.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v198.4c0 6.4 6.4 12.8 12.8 12.8zM496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"},child:[]}]})(e)}function B(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM464 96H345.94c-21.38 0-32.09 25.85-16.97 40.97l32.4 32.4L288 242.75l-73.37-73.37c-12.5-12.5-32.76-12.5-45.25 0l-68.69 68.69c-6.25 6.25-6.25 16.38 0 22.63l22.62 22.62c6.25 6.25 16.38 6.25 22.63 0L192 237.25l73.37 73.37c12.5 12.5 32.76 12.5 45.25 0l96-96 32.4 32.4c15.12 15.12 40.97 4.41 40.97-16.97V112c.01-8.84-7.15-16-15.99-16z"},child:[]}]})(e)}function O(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(e)}function R(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(e)}function F(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function T(e){return x({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M0 432c0 26.5 21.5 48 48 48h480c26.5 0 48-21.5 48-48V256H0v176zm192-68c0-6.6 5.4-12 12-12h136c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H204c-6.6 0-12-5.4-12-12v-40zm-128 0c0-6.6 5.4-12 12-12h72c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM576 80v48H0V80c0-26.5 21.5-48 48-48h480c26.5 0 48 21.5 48 48z"},child:[]}]})(e)}function U(e){return x({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function D(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(e)}function $(e){return x({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M310.706 413.765c-1.314-6.63-7.835-10.872-14.424-9.369-10.692 2.439-27.422 5.413-45.426 5.413-56.763 0-101.929-34.79-121.461-85.449h113.689a12 12 0 0 0 11.708-9.369l6.373-28.36c1.686-7.502-4.019-14.631-11.708-14.631H115.22c-1.21-14.328-1.414-28.287.137-42.245H261.95a12 12 0 0 0 11.723-9.434l6.512-29.755c1.638-7.484-4.061-14.566-11.723-14.566H130.184c20.633-44.991 62.69-75.03 117.619-75.03 14.486 0 28.564 2.25 37.851 4.145 6.216 1.268 12.347-2.498 14.002-8.623l11.991-44.368c1.822-6.741-2.465-13.616-9.326-14.917C290.217 34.912 270.71 32 249.635 32 152.451 32 74.03 92.252 45.075 176H12c-6.627 0-12 5.373-12 12v29.755c0 6.627 5.373 12 12 12h21.569c-1.009 13.607-1.181 29.287-.181 42.245H12c-6.627 0-12 5.373-12 12v28.36c0 6.627 5.373 12 12 12h30.114C67.139 414.692 145.264 480 249.635 480c26.301 0 48.562-4.544 61.101-7.788 6.167-1.595 10.027-7.708 8.788-13.957l-8.818-44.49z"},child:[]}]})(e)}function I(e){return x({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(e)}function q(e){return x({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(e)}function K(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(e)}function W(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M80 368H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm0-320H16A16 16 0 0 0 0 64v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16zm0 160H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm416 176H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"},child:[]}]})(e)}function Z(e){return x({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(e)}function G(e){return x({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M112 224c61.9 0 112-50.1 112-112S173.9 0 112 0 0 50.1 0 112s50.1 112 112 112zm0-160c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48 21.5-48 48-48zm224 224c-61.9 0-112 50.1-112 112s50.1 112 112 112 112-50.1 112-112-50.1-112-112-112zm0 160c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zM392.3.2l31.6-.1c19.4-.1 30.9 21.8 19.7 37.8L77.4 501.6a23.95 23.95 0 0 1-19.6 10.2l-33.4.1c-19.5 0-30.9-21.9-19.7-37.8l368-463.7C377.2 4 384.5.2 392.3.2z"},child:[]}]})(e)}function J(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(e)}function Y(e){return x({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function Q(e){return x({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(e)}function X(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function ee(e){return x({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M352 160v-32C352 57.42 294.579 0 224 0 153.42 0 96 57.42 96 128v32H0v272c0 44.183 35.817 80 80 80h288c44.183 0 80-35.817 80-80V160h-96zm-192-32c0-35.29 28.71-64 64-64s64 28.71 64 64v32H160v-32zm160 120c-13.255 0-24-10.745-24-24s10.745-24 24-24 24 10.745 24 24-10.745 24-24 24zm-192 0c-13.255 0-24-10.745-24-24s10.745-24 24-24 24 10.745 24 24-10.745 24-24 24z"},child:[]}]})(e)}function se(e){return x({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528.12 301.319l47.273-208C578.806 78.301 567.391 64 551.99 64H159.208l-9.166-44.81C147.758 8.021 137.93 0 126.529 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24h69.883l70.248 343.435C147.325 417.1 136 435.222 136 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-15.674-6.447-29.835-16.824-40h209.647C430.447 426.165 424 440.326 424 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-22.172-12.888-41.332-31.579-50.405l5.517-24.276c3.413-15.018-8.002-29.319-23.403-29.319H218.117l-6.545-32h293.145c11.206 0 20.92-7.754 23.403-18.681z"},child:[]}]})(e)}function te(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function ae(e){return x({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M312 320h136V56c0-13.3-10.7-24-24-24H24C10.7 32 0 42.7 0 56v400c0 13.3 10.7 24 24 24h264V344c0-13.2 10.8-24 24-24zm129 55l-98 98c-4.5 4.5-10.6 7-17 7h-6V352h128v6.1c0 6.3-2.5 12.4-7 16.9z"},child:[]}]})(e)}function le(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"},child:[]}]})(e)}function re(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"},child:[]}]})(e)}function ie(e){return x({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function ne(e){return x({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function ce(e){return x({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.3 271.1l-115.2-45c-4.1-1.6-12.6-3.7-22.2 0l-115.2 45c-10.7 4.2-17.7 14-17.7 24.9 0 111.6 68.7 188.8 132.9 213.9 9.6 3.7 18 1.6 22.2 0C558.4 489.9 640 420.5 640 296c0-10.9-7-20.7-17.7-24.9zM496 462.4V273.3l95.5 37.3c-5.6 87.1-60.9 135.4-95.5 151.8zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm96 40c0-2.5.8-4.8 1.1-7.2-2.5-.1-4.9-.8-7.5-.8h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c6.8 0 13.3-1.5 19.2-4-54-42.9-99.2-116.7-99.2-212z"},child:[]}]})(e)}function oe(e){return x({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}function de(e){return x({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}function xe({isOpen:s,onClose:t,onProductAdded:a}){const[l,r]=e.useState(""),[i,n]=e.useState([]),[c,o]=e.useState(null),[d,x]=e.useState([]),[m,h]=e.useState(""),[u,p]=e.useState(""),[b,f]=e.useState(!1),[j,v]=e.useState(null),[g,w]=e.useState({fee_percent:.2,fee_fixed:5}),[y,k]=e.useState(!1),[_,z]=e.useState("");e.useEffect(()=>{s?L().then(e=>{w(e)}).catch(e=>{console.warn("Failed to load fees:",e)}):(r(""),o(null),h(""),p(""),z(""),v(null),n([]),x([]))},[s]);const S=parseInt(u),P=isNaN(S)?null:M(S,g.fee_percent,g.fee_fixed),E=d.find(e=>e.size===m),V=E?.final_price||0;let A="text-slate-700",H="",B=null;!isNaN(S)&&S>0&&(S>V?(A="text-red-600",H="Tvoja cena je vyššia ako najnižšia cena!",B=N.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 ml-2",children:"Vyššia"})):S<V&&(A="text-green-600",H=`Najnižšia nová cena bude ${S} €`,B=N.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 ml-2",children:"Najnižšia"}))),e.useEffect(()=>{const e=setTimeout(async()=>{if(!l||l.length<2)return void n([]);const e=new AbortController,s=setTimeout(()=>e.abort(),5e3);k(!0);try{const{data:t,error:a}=await C.from("products").select("id, name, image_url, sku").ilike("name",`%${l}%`).limit(10).abortSignal(e.signal);if(clearTimeout(s),a)throw a;n((t||[]).map(e=>({product_id:e.id,size:"",final_price:0,final_status:"Skladom",product_name:e.name,image_url:e.image_url,sku:e.sku})))}catch(t){clearTimeout(s),console.error("Error in fetchExistingProducts:",t),"AbortError"===t.name?v("Vyhľadávanie trvá príliš dlho. Skúste znova."):v(t.message)}finally{k(!1)}},300);return()=>clearTimeout(e)},[l]);const R=async e=>{const s=new AbortController,t=setTimeout(()=>s.abort(),5e3);o(e),p(""),v(null);try{const{data:a,error:l}=await C.from("product_price_view").select("size, final_price, final_status").eq("product_id",e.product_id).order("final_price",{ascending:!0}).abortSignal(s.signal);if(clearTimeout(t),l)throw l;const r=a?[...a].sort((e,s)=>{const t=parseFloat(e.size),a=parseFloat(s.size);return isNaN(t)||isNaN(a)?e.size.localeCompare(s.size):t-a}).map(s=>({product_id:e.product_id,size:s.size,final_price:s.final_price,final_status:s.final_status,product_name:e.product_name,image_url:e.image_url,sku:e.sku})):[];x(r),z(e.sku||"Neznámé SKU")}catch(a){clearTimeout(t),console.error("Error fetching sizes:",a),"AbortError"===a.name?v("Načítavanie veľkostí trvá príliš dlho. Skúste znova."):v(a.message)}};return s?N.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:N.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[N.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[N.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Pridať produkt"}),N.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 rounded-xl transition-colors",children:N.jsx(ie,{className:"text-slate-500"})})]}),N.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:N.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!c||!m||isNaN(S)||S<=0)return void v("Prosím, vyberte produkt, veľkosť a zadajte platnú cenu.");const s=new AbortController,l=setTimeout(()=>s.abort(),1e4);f(!0),v(null);try{const{data:{user:e}}=await C.auth.getUser();if(!e)throw new Error("User not authenticated");const r=crypto.randomUUID(),{error:i}=await C.from("user_products").insert([{id:r,user_id:e.id,product_id:c.product_id,name:c.product_name,size:m,price:S,image_url:c.image_url,original_price:V,payout:P??0,sku:_}]).abortSignal(s.signal);if(clearTimeout(l),i)throw i;const n={id:r,user_id:e.id,product_id:c.product_id,name:c.product_name,size:m,price:S,image_url:c.image_url,original_price:V,payout:P??0,sku:_};a(n),o(null),h(""),p(""),z(""),t()}catch(r){clearTimeout(l),console.error("Error in handleSubmit:",r),"AbortError"===r.name?v("Pridávanie produktu trvá príliš dlho. Skúste znova."):v(r.message)}finally{f(!1)}},className:"space-y-6",children:[c?N.jsxs("div",{className:"space-y-6",children:[N.jsx("div",{className:"bg-slate-50 rounded-xl p-4",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx("div",{className:"h-16 w-16 flex-shrink-0 overflow-hidden rounded-xl border border-slate-200 bg-white",children:N.jsx("img",{src:c.image_url||"/default-image.png",alt:c.product_name,className:"h-full w-full object-contain p-2"})}),N.jsxs("div",{children:[N.jsx("h3",{className:"font-semibold text-slate-900",children:c.product_name}),N.jsx("p",{className:"text-sm text-slate-600",children:"Vybraný produkt"}),N.jsxs("p",{className:"text-sm text-slate-600",children:["SKU: ",_]})]})]}),N.jsx("button",{type:"button",onClick:()=>{o(null),h(""),p(""),z(""),v(null),r("")},className:"text-sm text-slate-600 hover:text-slate-900 font-medium px-3 py-1 hover:bg-white rounded-lg transition-colors",children:"Zmeniť"})]})}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:"Veľkosť"}),N.jsxs("select",{value:m,onChange:e=>{h(e.target.value),p("")},className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",required:!0,children:[N.jsx("option",{value:"",children:"Vyberte veľkosť"}),d.map((e,s)=>N.jsx("option",{value:e.size,children:e.size},s))]})]}),m&&N.jsxs("div",{className:"space-y-4",children:[N.jsx("div",{className:"bg-blue-50 rounded-xl p-4",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),N.jsx("div",{className:"ml-3",children:N.jsxs("p",{className:"text-sm font-medium text-blue-800",children:["Najnižšia trhová cena: ",N.jsxs("span",{className:"font-bold",children:[V," €"]})]})})]})}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:"Vaša predajná cena"}),N.jsxs("div",{className:"relative",children:[N.jsx("input",{type:"number",value:u,onChange:e=>p(e.target.value.replace(/[^0-9]/g,"")),className:"block w-full px-4 py-3 border rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent "+("text-red-600"===A?"border-red-300":"text-green-600"===A?"border-green-300":"border-slate-300"),placeholder:"Zadajte cenu v eurách",min:"1",required:!0}),N.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:N.jsx("span",{className:"text-slate-500 text-sm",children:"€"})})]}),H&&N.jsxs("div",{className:`mt-2 flex items-center text-sm ${A}`,children:[B,N.jsx("span",{className:"ml-2",children:H})]}),null!==P&&N.jsx("div",{className:"mt-3 bg-green-50 rounded-xl p-4",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-green-800",children:"Váš payout"}),N.jsxs("p",{className:"text-xs text-green-600",children:["Po odpočítaní poplatkov (",100*g.fee_percent,"% + ",g.fee_fixed,"€)"]})]}),N.jsxs("p",{className:"text-lg font-bold text-green-900",children:[P.toFixed(2)," €"]})]})})]})]})]}):N.jsxs(N.Fragment,{children:[N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:"Vyhľadajte produkt"}),N.jsxs("div",{className:"relative",children:[N.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:N.jsx(X,{className:"h-5 w-5 text-slate-400"})}),N.jsx("input",{type:"text",value:l,onChange:e=>r(e.target.value),className:"block w-full pl-10 pr-3 py-3 border border-slate-300 rounded-xl shadow-sm placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",placeholder:"Začnite písať názov produktu..."})]})]}),y&&N.jsx("div",{className:"text-center py-4",children:N.jsxs("div",{className:"inline-flex items-center text-sm text-slate-500",children:[N.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-slate-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Vyhľadávam produkty..."]})}),i.length>0&&N.jsx("div",{className:"border border-slate-200 rounded-xl divide-y divide-slate-200 max-h-64 overflow-y-auto",children:i.map(e=>N.jsxs("div",{className:"p-4 cursor-pointer hover:bg-slate-50 flex items-center space-x-4 transition-colors",onClick:()=>R(e),children:[N.jsx("div",{className:"h-16 w-16 flex-shrink-0 overflow-hidden rounded-xl border border-slate-200 bg-white",children:N.jsx("img",{src:e.image_url||"/default-image.png",alt:e.product_name,className:"h-full w-full object-contain p-2"})}),N.jsxs("div",{className:"flex-1 min-w-0",children:[N.jsx("p",{className:"text-sm font-semibold text-slate-900 truncate",children:e.product_name}),N.jsxs("p",{className:"text-xs text-slate-500",children:["SKU: ",e.sku||"N/A"]})]})]},e.product_id))})]}),j&&N.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx(I,{className:"h-5 w-5 text-red-400"})}),N.jsx("div",{className:"ml-3",children:N.jsx("p",{className:"text-sm text-red-800",children:j})})]}),N.jsx("button",{onClick:()=>{v(null),c&&R(c)},className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Skúsiť znova"})]})}),N.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-slate-200",children:[N.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 text-sm font-semibold text-slate-700 bg-white hover:bg-slate-50 border border-slate-300 rounded-xl transition-colors",children:"Zrušiť"}),N.jsx("button",{type:"submit",disabled:b||!c||!m||!u,className:"px-6 py-3 text-sm font-semibold text-white bg-gradient-to-r from-slate-900 to-slate-700 hover:from-slate-800 hover:to-slate-600 rounded-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:b?N.jsxs(N.Fragment,{children:[N.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Pridáva sa..."]}):N.jsxs(N.Fragment,{children:[N.jsx(O,{className:"mr-2"}),"Pridať produkt"]})})]})]})})]})}):null}function me({isOpen:s,onClose:t,onProductUpdated:a,product:l}){const[r,i]=e.useState(""),[n,c]=e.useState(!1),[o,d]=e.useState(null),[x,m]=e.useState("text-slate-700"),[h,u]=e.useState(!0),[p,b]=e.useState(""),[f,j]=e.useState(null),[v,g]=e.useState({fee_percent:.2,fee_fixed:5}),[w,y]=e.useState(null);e.useEffect(()=>{s&&(L().then(e=>{g(e??{fee_percent:.2,fee_fixed:5})}),l&&k(l))},[s,l]);const k=async e=>{try{const{data:s,error:t}=await C.from("product_price_view").select("final_price").eq("product_id",e.product_id).eq("size",e.size).eq("final_status","Skladom").order("final_price",{ascending:!0}).limit(1).single();if(t)throw t;s&&y(s.final_price)}catch(s){console.error("Error fetching current market price:",s)}},_=parseFloat(r),z=v?.fee_percent??.2,S=v?.fee_fixed??5,P=isNaN(_)?0:M(_,z,S),E=w||l?.original_price||l?.price||0;e.useEffect(()=>{if(l){i(l.price.toString());const e=l.price;V(e,E)}},[l,E]);const V=(e,s)=>{e>s?(m("text-red-600"),b("Tvoja cena je vyššia ako najnižšia cena!"),j(N.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 ml-2",children:"Vyššia"}))):e<s?(m("text-green-600"),b(`Najnižšia nová cena bude ${e} €`),j(N.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 ml-2",children:"Najnižšia"}))):(m("text-slate-700"),b("Cena je platná."),j(null))};return s&&l?N.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:N.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl",children:[N.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[N.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Upraviť produkt"}),N.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 rounded-xl transition-colors",children:N.jsx(ie,{className:"text-slate-500"})})]}),N.jsx("div",{className:"p-6",children:N.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),l&&h){c(!0),d(null);try{const{error:e}=await C.from("user_products").update({price:parseFloat(r),payout:P}).eq("id",l.id);if(e)throw e;const s={...l,price:parseFloat(r),payout:P};a(s),t()}catch(s){console.error("Error updating product:",s),d(s.message)}finally{c(!1)}}},className:"space-y-6",children:[N.jsx("div",{className:"bg-slate-50 rounded-xl p-4",children:N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx("div",{className:"h-20 w-20 flex-shrink-0 overflow-hidden rounded-xl border border-slate-200 bg-white",children:l.image_url&&N.jsx("img",{src:l.image_url,alt:l.name,className:"h-full w-full object-contain p-2"})}),N.jsxs("div",{className:"flex-1",children:[N.jsx("h3",{className:"font-semibold text-slate-900 text-lg",children:l.name}),N.jsxs("div",{className:"flex items-center mt-2",children:[N.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-slate-200 text-slate-800",children:["Veľkosť: ",l.size]}),N.jsxs("span",{className:"inline-flex items-center px-3 py-1 text-sm font-medium text-slate-800 ml-2",children:["SKU: ",l.sku," "]})]})]})]})}),w&&N.jsx("div",{className:"bg-blue-50 rounded-xl p-4",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),N.jsx("div",{className:"ml-3",children:N.jsxs("p",{className:"text-sm font-medium text-blue-800",children:["Aktuálna trhová cena: ",N.jsxs("span",{className:"font-bold",children:[w," €"]})]})})]})}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:"Nová cena"}),N.jsxs("div",{className:"relative",children:[N.jsx("input",{type:"number",value:r,onChange:e=>{const s=e.target.value.replace(/[^0-9.]/g,"").replace(/(\..*)\./g,"$1");i(s);const t=parseFloat(s);isNaN(t)||t<=0?(u(!1),m("text-red-600"),b("Cena musí byť kladné číslo."),j(null)):(u(!0),V(t,E))},className:"block w-full px-4 py-3 border rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent "+("text-red-600"===x?"border-red-300":"text-green-600"===x?"border-green-300":"border-slate-300"),placeholder:"Zadajte novú cenu",step:"1",min:"1",required:!0}),N.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:N.jsx("span",{className:"text-slate-500 text-sm",children:"€"})})]}),p&&N.jsxs("div",{className:`mt-2 flex items-center text-sm ${x}`,children:[f,N.jsx("span",{className:"ml-2",children:p})]}),null!==P&&N.jsx("div",{className:"mt-3 bg-green-50 rounded-xl p-4",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-green-800",children:"Váš payout"}),N.jsxs("p",{className:"text-xs text-green-600",children:["Po odpočítaní poplatkov (",100*v.fee_percent,"% + ",v.fee_fixed,"€)"]})]}),N.jsxs("p",{className:"text-lg font-bold text-green-900",children:[P.toFixed(2)," €"]})]})})]}),o&&N.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),N.jsx("div",{className:"ml-3",children:N.jsx("p",{className:"text-sm text-red-800",children:o})})]})}),N.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-slate-200",children:[N.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 text-sm font-semibold text-slate-700 bg-white hover:bg-slate-50 border border-slate-300 rounded-xl transition-colors",children:"Zrušiť"}),N.jsx("button",{type:"submit",disabled:!h||n,className:"px-6 py-3 text-sm font-semibold text-white bg-gradient-to-r from-slate-900 to-slate-700 hover:from-slate-800 hover:to-slate-600 rounded-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:n?N.jsxs(N.Fragment,{children:[N.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Upravuje sa..."]}):N.jsxs(N.Fragment,{children:[N.jsx(O,{className:"mr-2"}),"Uložiť zmeny"]})})]})]})})]})}):null}function he({isAdmin:s}){const t=a(),[r,i]=e.useState(null),[n,c]=e.useState(!0),[o,d]=e.useState([]),[x,m]=e.useState({}),[h,u]=e.useState(!1),[p,b]=e.useState(!1),[f,j]=e.useState(null),[v,g]=e.useState(null),[w,y]=e.useState({fee_percent:.2,fee_fixed:5}),[k,_]=e.useState(!1),[z,S]=e.useState(!1),P=e.useCallback(async e=>{const s=new AbortController,t=setTimeout(()=>s.abort(),1e4);try{g(null);const{data:a,error:l}=await C.from("user_products").select("*").eq("user_id",e).order("created_at",{ascending:!1}).abortSignal(s.signal);if(clearTimeout(t),l)throw new Error(`Chyba pri načítavaní produktov: ${l.message}`);if(Array.isArray(a)){const e=a.filter(e=>null!=e);d(e),e.length>0&&M(e).catch(e=>{console.warn("Market prices failed to load:",e.message)})}else d([])}catch(a){clearTimeout(t),console.error("Error fetching products:",a.message),"AbortError"===a.name?g("Načítavanie produktov trvá príliš dlho. Skúste obnoviť stránku."):g(a.message||"Došlo k chybe pri načítavaní produktov"),d([])}},[]),M=e.useCallback(async e=>{try{S(!0);const s={},t=e.slice(0,10).map(async e=>{try{const t=new AbortController,a=setTimeout(()=>t.abort(),3e3),{data:l,error:r}=await C.from("product_price_view").select("final_price").eq("product_id",e.product_id).eq("size",e.size).eq("final_status","Skladom").order("final_price",{ascending:!0}).limit(1).single();if(clearTimeout(a),r&&"PGRST116"!==r.code)return;if(l){const t=`${e.product_id}-${e.size}`;s[t]=l.final_price}}catch(t){"AbortError"!==t.name&&console.warn(`Error fetching market price for product ${e.product_id}:`,t.message)}});await Promise.allSettled(t),m(s)}catch(s){console.error("Error fetching market prices:",s.message)}finally{S(!1)}},[]),E=e.useCallback(async()=>{const e=new AbortController,s=setTimeout(()=>e.abort(),8e3);try{g(null);const{data:{user:e},error:a}=await C.auth.getUser();if(clearTimeout(s),a)throw new Error(`Chyba autentifikácie: ${a.message}`);if(!e)return void t("/");i(e);const[l,r]=await Promise.allSettled([L(),P(e.id)]);"fulfilled"===l.status?y(l.value):console.warn("Failed to load fees, using defaults"),"rejected"===r.status&&console.warn("Failed to load products:",r.reason)}catch(a){clearTimeout(s),console.error("Error initializing user:",a.message),"AbortError"===a.name?g("Načítavanie trvá príliš dlho. Skúste obnoviť stránku."):g(a.message||"Chyba pri načítavaní používateľa")}finally{c(!1)}},[t,P]);e.useEffect(()=>{s&&r&&!n&&t("/admin",{replace:!0})},[s,r,n,t]),e.useEffect(()=>{let e=!0;return(async()=>{e&&await E()})(),()=>{e=!1}},[]);const V=()=>{g(null),c(!0),E()};if(n)return N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100 flex items-center justify-center",children:N.jsxs("div",{className:"text-center",children:[N.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-white rounded-xl shadow-lg mb-3",children:N.jsxs("svg",{className:"animate-spin h-6 w-6 text-slate-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),N.jsx("p",{className:"text-lg text-slate-600 mb-2",children:"Načítava sa dashboard..."}),N.jsx("p",{className:"text-sm text-slate-500",children:"Ak sa načítavanie zdá príliš dlhé, skúste obnoviť stránku"}),v&&N.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-xl max-w-md mx-auto",children:[N.jsxs("div",{className:"flex items-center text-red-800 mb-2",children:[N.jsx(I,{className:"mr-2"}),N.jsx("span",{className:"font-semibold",children:"Chyba"})]}),N.jsx("p",{className:"text-red-700 text-sm mb-3",children:v}),N.jsx("button",{onClick:V,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm",children:"Skúsiť znova"})]})]})});if(!r)return N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100 flex items-center justify-center",children:N.jsxs("div",{className:"text-center",children:[N.jsx("div",{className:"text-lg text-slate-600 mb-4",children:"Používateľ neexistuje alebo nie je prihlásený."}),N.jsx("button",{onClick:()=>t("/"),className:"px-6 py-3 bg-slate-900 text-white rounded-xl hover:bg-slate-800 transition-colors",children:"Prihlásiť sa"})]})});const A=o.reduce((e,s)=>e+s.payout,0);return N.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100",children:[N.jsx("header",{className:"bg-white/80 backdrop-blur-sm border-b border-slate-200/50 sticky top-0 z-40",children:N.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-gradient-to-br from-slate-900 to-slate-700 rounded-xl",children:N.jsx(ee,{className:"text-white text-lg"})}),N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Seller Hub"}),N.jsx("p",{className:"text-sm text-slate-600",children:"Správa vašich produktov"})]})]}),N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-slate-900 to-slate-700 text-white font-semibold rounded-xl hover:from-slate-800 hover:to-slate-600 transition-all duration-200 transform hover:scale-105 shadow-lg",children:[N.jsx(Y,{className:"mr-2 text-sm"}),"Pridať produkt"]}),N.jsxs(l,{to:"/sales",className:"inline-flex items-center px-4 py-2 bg-white text-slate-700 font-semibold rounded-xl hover:bg-slate-50 transition-all duration-200 border border-slate-200 shadow-sm",children:[N.jsx(B,{className:"mr-2 text-sm"}),"Predaje"]}),N.jsxs(l,{to:"/profile",className:"inline-flex items-center px-4 py-2 bg-white text-slate-700 font-semibold rounded-xl hover:bg-slate-50 transition-all duration-200 border border-slate-200 shadow-sm",children:[N.jsx(oe,{className:"mr-2 text-sm"}),"Profil"]}),s&&N.jsxs(l,{to:"/admin",className:"inline-flex items-center px-4 py-2 bg-red-50 text-red-600 font-semibold rounded-xl hover:bg-red-100 transition-all duration-200 border border-red-200",children:[N.jsx(F,{className:"mr-2 text-sm"}),"Admin"]}),N.jsxs("button",{onClick:async()=>{try{await C.auth.signOut(),t("/")}catch(e){console.error("Error signing out:",e.message),g("Chyba pri odhlasovaní")}},className:"inline-flex items-center px-4 py-2 bg-red-50 text-red-600 font-semibold rounded-xl hover:bg-red-100 transition-all duration-200 border border-red-200",children:[N.jsx(te,{className:"mr-2 text-sm"}),"Odhlásiť"]})]})]})})}),N.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[v&&N.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-xl p-4",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx(I,{className:"h-5 w-5 text-red-400"})}),N.jsx("div",{className:"ml-3",children:N.jsx("p",{className:"text-sm text-red-800",children:v})})]}),N.jsxs("div",{className:"flex space-x-2",children:[N.jsx("button",{onClick:V,className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Skúsiť znova"}),N.jsx("button",{onClick:()=>g(null),className:"text-red-400 hover:text-red-600",children:N.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})}),N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[N.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-lg",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:N.jsx(ee,{className:"text-blue-600 text-xl"})})}),N.jsxs("div",{className:"ml-4",children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Celkový počet produktov"}),N.jsx("p",{className:"text-2xl font-bold text-slate-900",children:o.length})]})]})}),N.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-lg",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:N.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})})}),N.jsxs("div",{className:"ml-4",children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Celkový payout"}),N.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[A.toFixed(2)," €"]})]})]})}),N.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-lg",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:N.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})})}),N.jsxs("div",{className:"ml-4",children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Priemerná cena"}),N.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[o.length>0?(o.reduce((e,s)=>e+s.price,0)/o.length).toFixed(2):"0.00"," €"]})]})]})})]}),N.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-white/20 shadow-lg overflow-hidden",children:[N.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex justify-between items-center",children:[N.jsxs("div",{children:[N.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Vaše produkty"}),z&&N.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Načítavajú sa trhové ceny..."})]}),N.jsxs("button",{onClick:async()=>{if(r&&!k){_(!0);try{await P(r.id),g(null)}catch(e){g(e.message)}finally{_(!1)}}},disabled:k,className:"inline-flex items-center px-4 py-2 bg-blue-50 text-blue-600 font-semibold rounded-xl hover:bg-blue-100 transition-all duration-200 border border-blue-200 disabled:opacity-50",title:"Obnoviť produkty",children:[N.jsx(le,{className:"mr-2 text-sm "+(k?"animate-spin":"")}),k?"Obnovuje sa...":"Obnoviť"]})]}),o.length>0?N.jsx("div",{className:"overflow-x-auto",children:N.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[N.jsx("thead",{className:"bg-slate-50/50",children:N.jsxs("tr",{children:[N.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"#"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Produkt"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Veľkosť"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"SKU"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Cena"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Payout"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Akcie"})]})}),N.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:o.map((e,s)=>{const t=x[`${e.product_id}-${e.size}`];let a="text-slate-900",l="",r=null;return null!=t&&(e.price<=t?(a="text-green-600 font-semibold",e.price<t&&(l=`(-${(t-e.price).toFixed(2)} €)`,r=N.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 ml-2",children:"Najnižšia"}))):(a="text-red-600 font-semibold",l=`(+${(e.price-t).toFixed(2)} €)`,r=N.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 ml-2",children:"Vyššia"}))),N.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors",children:[N.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-500 font-medium",children:s+1}),N.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"h-16 w-16 flex-shrink-0 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-sm",children:N.jsx("img",{className:"h-full w-full object-contain p-2",src:e?.image_url||"/default-image.png",alt:e?.name||"Žiadny obrázok",onError:e=>{e.target.src="/default-image.png"}})}),N.jsxs("div",{className:"ml-4",children:[N.jsx("div",{className:"text-sm font-semibold text-slate-900",children:e?.name||"Neznámy názov"}),t&&N.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Trhová cena: ",t," €"]})]})]})}),N.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-slate-100 text-slate-800",children:e?.size||"Neznáma veľkosť"})}),N.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900",children:e.sku||"N/A"}),N.jsxs("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${a}`,children:[N.jsxs("div",{className:"flex items-center",children:[e?.price?`${e.price} €`:"Neznáma cena",r]}),l&&N.jsx("div",{className:"text-xs text-slate-500 mt-1",children:l})]}),N.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-slate-900",children:[(e.payout??0).toFixed(2)," €"]}),N.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsx("button",{onClick:()=>(e=>{j(e),b(!0)})(e),className:"text-slate-600 hover:text-slate-900 transition-colors p-2 hover:bg-slate-100 rounded-lg",title:"Upraviť produkt",children:N.jsx(U,{className:"h-4 w-4"})}),N.jsx("button",{onClick:()=>(async e=>{if(confirm("Naozaj chcete odstrániť tento produkt?"))try{const{error:s}=await C.from("user_products").delete().eq("id",e);if(s)throw new Error(`Chyba pri odstraňovaní produktu: ${s.message}`);d(s=>s.filter(s=>s.id!==e)),g(null)}catch(s){console.error("Error deleting product:",s.message),g(s.message)}})(e.id),className:"text-red-600 hover:text-red-700 transition-colors p-2 hover:bg-red-50 rounded-lg",title:"Odstrániť produkt",children:N.jsx(ne,{className:"h-4 w-4"})})]})})]},e.id)})})]})}):N.jsxs("div",{className:"text-center py-12",children:[N.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:N.jsx(ee,{className:"text-slate-400 text-2xl"})}),N.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Žiadne produkty"}),N.jsx("p",{className:"text-slate-600 mb-6",children:"Začnite pridaním svojho prvého produktu"}),N.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-slate-900 to-slate-700 text-white font-semibold rounded-xl hover:from-slate-800 hover:to-slate-600 transition-all duration-200 transform hover:scale-105",children:[N.jsx(Y,{className:"mr-2"}),"Pridať produkt"]})]})]}),N.jsx(xe,{isOpen:h,onClose:()=>u(!1),onProductAdded:e=>d(s=>[...s,e])}),f&&N.jsx(me,{isOpen:p,onClose:()=>b(!1),onProductUpdated:e=>{d(s=>s.map(s=>s.id===e.id?e:s)),b(!1),j(null)},product:f})]})]})}function ue(){const s=a(),[t,r]=e.useState(!0),[i,n]=e.useState(null),[c,o]=e.useState(""),[d,x]=e.useState({first_name:"",last_name:"",profile_type:"Osobný",vat_type:"",company_name:"",ico:"",vat_number:"",address:"",popisne_cislo:"",psc:"",mesto:"",krajina:"Slovensko",email:"",telephone:"",iban:""}),[m,h]=e.useState(!1),[u,p]=e.useState(null),[b,f]=e.useState(null);e.useEffect(()=>{let e,t=!0;return(async()=>{try{r(!0),p(null),e=setTimeout(()=>{t&&(p("Načítavanie profilu trvá príliš dlho. Skúste obnoviť stránku."),r(!1))},8e3);const l=C.auth.getUser(),i=new Promise((e,s)=>setTimeout(()=>s(new Error("User fetch timeout")),3e3)),{data:{user:c},error:d}=await Promise.race([l,i]);if(e&&clearTimeout(e),d)throw new Error("Chyba autentifikácie: "+d.message);if(!c)return void s("/");if(!t)return;n(c),o(c.email||"");const m=C.from("profiles").select("*").eq("id",c.id).single(),h=new Promise((e,s)=>setTimeout(()=>s(new Error("Profile fetch timeout")),5e3));try{const{data:e,error:s}=await Promise.race([m,h]);e&&t?x({first_name:e.first_name||"",last_name:e.last_name||"",profile_type:e.profile_type||"Osobný",vat_type:e.vat_type||"",company_name:e.company_name||"",ico:e.ico||"",vat_number:e.vat_number||"",address:e.address||"",popisne_cislo:e.popisne_cislo||"",psc:e.psc||"",mesto:e.mesto||"",krajina:e.krajina||"Slovensko",email:e.email||c.email,telephone:e.telephone||"",iban:e.iban||""}):t&&x(e=>({...e,email:c.email||""})),s&&"PGRST116"!==s.code&&console.warn("Profile error:",s.message)}catch(a){console.warn("Profile loading failed:",a.message),t&&x(e=>({...e,email:c.email||""}))}}catch(l){e&&clearTimeout(e),console.error("Error loading user data:",l.message),t&&p("Nepodarilo sa načítať profil. Skúste znova.")}finally{t&&r(!1)}})(),()=>{t=!1,e&&clearTimeout(e)}},[s]);const j=()=>{h(!1)};return t?N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100 flex items-center justify-center",children:N.jsxs("div",{className:"text-center",children:[N.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-2xl shadow-lg mb-4",children:N.jsxs("svg",{className:"animate-spin h-8 w-8 text-slate-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),N.jsx("p",{className:"text-lg text-slate-600 mb-2",children:"Načítava sa profil..."}),u&&N.jsxs("div",{className:"mt-4 text-red-600 text-sm max-w-md",children:[u,N.jsx("button",{onClick:()=>window.location.reload(),className:"block mx-auto mt-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Obnoviť stránku"})]})]})}):N.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100",children:[N.jsx("header",{className:"bg-white/80 backdrop-blur-sm border-b border-slate-200/50 sticky top-0 z-40",children:N.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-gradient-to-br from-slate-900 to-slate-700 rounded-xl",children:N.jsx(oe,{className:"text-white text-lg"})}),N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Môj profil"}),N.jsx("p",{className:"text-sm text-slate-600",children:"Osobné a fakturačné údaje"})]})]}),N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsxs(l,{to:"/dashboard",className:"inline-flex items-center px-4 py-2 bg-white text-slate-700 font-semibold rounded-xl hover:bg-slate-50 transition-all duration-200 border border-slate-200 shadow-sm",children:[N.jsx(E,{className:"mr-2 text-sm"}),"Späť na Dashboard"]}),N.jsxs(l,{to:"/sales",className:"inline-flex items-center px-4 py-2 bg-white text-slate-700 font-semibold rounded-xl hover:bg-slate-50 transition-all duration-200 border border-slate-200 shadow-sm",children:[N.jsx(B,{className:"mr-2 text-sm"}),"Predaje"]}),N.jsxs("button",{onClick:async()=>{try{await C.auth.signOut(),s("/")}catch(e){console.error("Error signing out:",e.message),p("Chyba pri odhlasení.")}},className:"inline-flex items-center px-4 py-2 bg-red-50 text-red-600 font-semibold rounded-xl hover:bg-red-100 transition-all duration-200 border border-red-200",children:[N.jsx(te,{className:"mr-2 text-sm"}),"Odhlásiť sa"]})]})]})})}),N.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[u&&N.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-xl p-4",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),N.jsx("div",{className:"ml-3",children:N.jsx("p",{className:"text-sm text-red-800",children:u})})]}),N.jsx("button",{onClick:()=>p(null),className:"text-red-400 hover:text-red-600",children:N.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})}),b&&N.jsx("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-xl p-4",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),N.jsx("div",{className:"ml-3",children:N.jsx("p",{className:"text-sm text-green-800",children:b})})]}),N.jsx("button",{onClick:()=>f(null),className:"text-green-400 hover:text-green-600",children:N.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})}),N.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-white/20 shadow-lg mb-8",children:[N.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center mr-3",children:N.jsx(oe,{className:"text-blue-600"})}),N.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Účet"})]})}),N.jsx("div",{className:"p-6",children:N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx(D,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Email"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:c})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx("svg",{className:"w-5 h-5 text-slate-400 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3a4 4 0 118 0v4m-4 6v6m-4-6h8m-8 0V9a2 2 0 012-2h4a2 2 0 012 2v2"})}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Účet vytvorený"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:i?.created_at?new Date(i.created_at).toLocaleDateString("sk-SK"):"N/A"})]})]})]})})]}),N.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-white/20 shadow-lg",children:[N.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center mr-3",children:N.jsx(oe,{className:"text-green-600"})}),N.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Osobné informácie"})]}),N.jsxs("div",{className:"flex space-x-2",children:[N.jsxs("button",{onClick:()=>{h(!0),p(null),f(null)},className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-slate-900 to-slate-700 text-white font-semibold rounded-xl hover:from-slate-800 hover:to-slate-600 transition-all duration-200 transform hover:scale-105 shadow-lg",children:[N.jsx(U,{className:"mr-2 text-sm"}),"Upraviť"]}),N.jsxs("button",{onClick:async()=>{if(window.confirm("Naozaj chcete odstrániť svoj profil? Táto akcia je nezvratná."))try{if(!i)return void p("Používateľ nie je prihlásený.");const{error:e}=await C.from("profiles").delete().eq("id",i.id);if(e)throw new Error("Chyba pri odstraňovaní profilu: "+e.message);x({first_name:"",last_name:"",profile_type:"Osobný",vat_type:"",company_name:"",ico:"",vat_number:"",address:"",popisne_cislo:"",psc:"",mesto:"",krajina:"Slovensko",email:i.email||"",telephone:"",iban:""}),f("Profil bol úspešne odstránený.")}catch(e){p("Neočakávaná chyba pri odstraňovaní profilu: "+e.message),console.error(e)}},className:"inline-flex items-center px-4 py-2 bg-red-50 text-red-600 font-semibold rounded-xl hover:bg-red-100 transition-all duration-200 border border-red-200",children:[N.jsx(ne,{className:"mr-2 text-sm"}),"Odstrániť"]})]})]})}),N.jsx("div",{className:"p-6",children:N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx(oe,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Meno"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:d.first_name||"—"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(oe,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Priezvisko"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:d.last_name||"—"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(A,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Typ profilu"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:d.profile_type||"—"})]})]}),"Obchodný"===d.profile_type&&N.jsxs(N.Fragment,{children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx(A,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Názov firmy"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:d.company_name||"—"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(A,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Typ DPH"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:d.vat_type||"—"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(A,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"IČO"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:d.ico||"—"})]})]}),"VAT 0%"===d.vat_type&&N.jsxs("div",{className:"flex items-center",children:[N.jsx(A,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Číslo DPH"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:d.vat_number||"—"})]})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(J,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Telefón"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:d.telephone||"—"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(Z,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Adresa"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:d.address||d.popisne_cislo?`${d.address||""} ${d.popisne_cislo||""}`.trim():"—"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(Z,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Mesto"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:d.mesto||"—"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(Z,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"PSČ"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:d.psc||"—"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(Z,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Krajina"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:d.krajina||"—"})]})]}),N.jsxs("div",{className:"flex items-center md:col-span-2",children:[N.jsx(T,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"IBAN"}),N.jsx("p",{className:"text-slate-900 font-semibold",children:d.iban||"—"})]})]})]})})]})]}),m&&N.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:N.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[N.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[N.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Upraviť profil"}),N.jsx("button",{onClick:j,className:"p-2 hover:bg-slate-100 rounded-xl transition-colors",children:N.jsx("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),N.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:N.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),p(null),f(null),"Obchodný"!==d.profile_type||d.company_name){if("Obchodný"===d.profile_type){if("MARGIN"===d.vat_type&&!d.ico)return void p("Pri výbere MARGIN je potrebné vyplniť IČO.");if(!("VAT 0%"!==d.vat_type||d.ico&&d.vat_number))return void p("Pri výbere VAT 0% je potrebné vyplniť IČO a číslo DPH.")}try{if(!i)return void p("Používateľ nie je prihlásený.");const e={id:i.id,first_name:d.first_name,last_name:d.last_name,profile_type:d.profile_type,vat_type:d.vat_type,company_name:"Obchodný"===d.profile_type?d.company_name:null,ico:"Obchodný"===d.profile_type?d.ico:null,vat_number:"VAT 0%"===d.vat_type?d.vat_number:null,address:d.address,popisne_cislo:d.popisne_cislo,psc:d.psc,mesto:d.mesto,krajina:d.krajina,email:d.email,telephone:d.telephone,iban:d.iban},{error:s}=await C.from("profiles").upsert(e,{onConflict:"id"});if(s)throw new Error("Chyba pri ukladaní profilu: "+s.message);f("Profil bol úspešne uložený!"),h(!1)}catch(s){p("Neočakávaná chyba pri ukladaní profilu: "+s.message),console.error(s)}}else p("Pri výbere Obchodný je potrebné vyplniť názov firmy.")},className:"space-y-6",children:[N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[N.jsxs("div",{children:[N.jsx("label",{htmlFor:"first_name",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Meno"}),N.jsx("input",{type:"text",id:"first_name",value:d.first_name,onChange:e=>x({...d,first_name:e.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",required:!0})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"last_name",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Priezvisko"}),N.jsx("input",{type:"text",id:"last_name",value:d.last_name,onChange:e=>x({...d,last_name:e.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",required:!0})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"profile_type",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Typ profilu"}),N.jsxs("select",{id:"profile_type",value:d.profile_type,onChange:e=>x({...d,profile_type:e.target.value,vat_type:"Osobný"===e.target.value?"PRIVATE":""}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",children:[N.jsx("option",{value:"Osobný",children:"Osobný"}),N.jsx("option",{value:"Obchodný",children:"Obchodný"})]})]}),"Obchodný"===d.profile_type&&N.jsxs("div",{children:[N.jsx("label",{htmlFor:"company_name",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Názov firmy"}),N.jsx("input",{type:"text",id:"company_name",value:d.company_name||"",onChange:e=>x({...d,company_name:e.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",required:"Obchodný"===d.profile_type})]}),"Obchodný"===d.profile_type&&N.jsxs("div",{children:[N.jsx("label",{htmlFor:"vat_type",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Typ DPH"}),N.jsxs("select",{id:"vat_type",value:d.vat_type,onChange:e=>x({...d,vat_type:e.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",children:[N.jsx("option",{value:"",children:"Vyberte typ"}),N.jsx("option",{value:"MARGIN",children:"MARGIN"}),N.jsx("option",{value:"VAT 0%",children:"VAT 0%"})]})]}),"Obchodný"===d.profile_type&&N.jsxs("div",{children:[N.jsx("label",{htmlFor:"ico",className:"block text-sm font-semibold text-slate-700 mb-2",children:"IČO"}),N.jsx("input",{type:"text",id:"ico",value:d.ico||"",onChange:e=>x({...d,ico:e.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",required:"Obchodný"===d.profile_type})]}),"Obchodný"===d.profile_type&&"VAT 0%"===d.vat_type&&N.jsxs("div",{children:[N.jsx("label",{htmlFor:"vat_number",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Číslo DPH"}),N.jsx("input",{type:"text",id:"vat_number",value:d.vat_number||"",onChange:e=>x({...d,vat_number:e.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",required:"VAT 0%"===d.vat_type})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"address",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Adresa"}),N.jsx("input",{type:"text",id:"address",value:d.address,onChange:e=>x({...d,address:e.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",required:!0})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"popisne_cislo",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Popisné číslo"}),N.jsx("input",{type:"text",id:"popisne_cislo",value:d.popisne_cislo,onChange:e=>x({...d,popisne_cislo:e.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",required:!0})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"psc",className:"block text-sm font-semibold text-slate-700 mb-2",children:"PSČ"}),N.jsx("input",{type:"text",id:"psc",value:d.psc,onChange:e=>x({...d,psc:e.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",required:!0})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"mesto",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Mesto"}),N.jsx("input",{type:"text",id:"mesto",value:d.mesto,onChange:e=>x({...d,mesto:e.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",required:!0})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"krajina",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Krajina"}),N.jsxs("select",{id:"krajina",value:d.krajina,onChange:e=>x({...d,krajina:e.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent",required:!0,children:[N.jsx("option",{value:"Slovensko",children:"Slovensko"}),N.jsx("option",{value:"Ceska Republika",children:"Česká Republika"}),N.jsx("option",{value:"Madarsko",children:"Maďarsko"}),N.jsx("option",{value:"Rumunsko",children:"Rumunsko"})]})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Email"}),N.jsx("input",{type:"email",id:"email",value:d.email,readOnly:!0,className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm bg-slate-50 text-slate-500"})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"telephone",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Telefónne číslo"}),N.jsx("input",{type:"text",id:"telephone",value:d.telephone,onChange:e=>x({...d,telephone:e.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent"})]})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"iban",className:"block text-sm font-semibold text-slate-700 mb-2",children:"IBAN"}),N.jsx("input",{type:"text",id:"iban",value:d.iban,onChange:e=>x({...d,iban:e.target.value}),className:"block w-full px-4 py-3 border border-slate-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent"})]}),N.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-slate-200",children:[N.jsx("button",{type:"button",onClick:j,className:"px-6 py-3 text-sm font-semibold text-slate-700 bg-white hover:bg-slate-50 border border-slate-300 rounded-xl transition-colors",children:"Zrušiť"}),N.jsx("button",{type:"submit",className:"px-6 py-3 text-sm font-semibold text-white bg-gradient-to-r from-slate-900 to-slate-700 hover:from-slate-800 hover:to-slate-600 rounded-xl transition-all duration-200",children:"Uložiť zmeny"})]})]})})]})})]})}const pe={accepted:{label:"Prijatý",color:"bg-blue-100 text-blue-800 border-blue-200",icon:O,description:"Predaj bol prijatý a spracováva sa"},processing:{label:"Spracováva sa",color:"bg-yellow-100 text-yellow-800 border-yellow-200",icon:F,description:"Predaj sa pripravuje na odoslanie"},shipped:{label:"Odoslaný",color:"bg-purple-100 text-purple-800 border-purple-200",icon:function(e){return x({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 352h-16V243.9c0-12.7-5.1-24.9-14.1-33.9L494 110.1c-9-9-21.2-14.1-33.9-14.1H416V48c0-26.5-21.5-48-48-48H112C85.5 0 64 21.5 64 48v48H8c-4.4 0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h272c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H40c-4.4 0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h208c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H8c-4.4 0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h208c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H64v128c0 53 43 96 96 96s96-43 96-96h128c0 53 43 96 96 96s96-43 96-96h48c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zM160 464c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm320 0c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm80-208H416V144h44.1l99.9 99.9V256z"},child:[]}]})(e)},description:"Produkt bol odoslaný kupujúcemu"},delivered:{label:"Doručený",color:"bg-indigo-100 text-indigo-800 border-indigo-200",icon:function(e){return x({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 352h-16V243.9c0-12.7-5.1-24.9-14.1-33.9L494 110.1c-9-9-21.2-14.1-33.9-14.1H416V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h16c0 53 43 96 96 96s96-43 96-96h128c0 53 43 96 96 96s96-43 96-96h48c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zM160 464c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm320 0c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm80-208H416V144h44.1l99.9 99.9V256z"},child:[]}]})(e)},description:"Produkt bol doručený kupujúcemu"},completed:{label:"Dokončený",color:"bg-green-100 text-green-800 border-green-200",icon:function(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(e)},description:"Predaj je dokončený, payout vyplatený"},cancelled:{label:"Zrušený",color:"bg-red-100 text-red-800 border-red-200",icon:ie,description:"Predaj bol zrušený"},returned:{label:"Vrátený",color:"bg-orange-100 text-orange-800 border-orange-200",icon:function(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(e)},description:"Produkt bol vrátený"}};function be({status:e,className:s=""}){const t=pe[e]||pe.accepted,a=t.icon;return N.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium border ${t.color} ${s}`,title:t.description,children:[N.jsx(a,{className:"mr-2 text-xs"}),t.label]})}function fe({saleId:s,currentStatus:t}){const[a,l]=e.useState([]),[r,i]=e.useState(!0),[n,c]=e.useState(null);e.useEffect(()=>{s&&(async()=>{try{i(!0),c(null);const{data:e,error:t}=await C.from("sales_status_history").select("*").eq("sale_id",s).order("created_at",{ascending:!1});if(t)throw t;l(e||[])}catch(e){console.error("Error fetching sales status history:",e),c("Chyba pri načítavaní histórie statusu")}finally{i(!1)}})()},[s]);return r?N.jsxs("div",{className:"flex items-center justify-center py-4",children:[N.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-slate-600"}),N.jsx("span",{className:"ml-2 text-sm text-slate-600",children:"Načítava sa história..."})]}):n?N.jsx("div",{className:"text-center py-4",children:N.jsx("p",{className:"text-sm text-red-600",children:n})}):N.jsxs("div",{className:"space-y-4",children:[N.jsx("h4",{className:"text-lg font-semibold text-slate-900 mb-4",children:"História predaja"}),N.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-slate-50 rounded-lg border-l-4 border-green-500",children:[N.jsx(be,{status:t}),N.jsxs("div",{className:"flex-1",children:[N.jsx("p",{className:"text-sm font-medium text-slate-900",children:"Aktuálny status"}),N.jsx("p",{className:"text-xs text-slate-500",children:"Posledná aktualizácia"})]})]}),N.jsx("div",{className:"space-y-3",children:a.length>0?a.map((e,s)=>{return N.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-white rounded-lg border border-slate-200",children:[N.jsx("div",{className:"flex-shrink-0 mt-1",children:N.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center",children:N.jsx(R,{className:"text-slate-500 text-xs"})})}),N.jsxs("div",{className:"flex-1 min-w-0",children:[N.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.old_status&&N.jsxs(N.Fragment,{children:[N.jsx(be,{status:e.old_status,className:"text-xs"}),N.jsx("span",{className:"text-slate-400",children:"→"})]}),N.jsx(be,{status:e.new_status,className:"text-xs"})]}),N.jsxs("div",{className:"flex items-center space-x-4 text-xs text-slate-500",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx(R,{className:"mr-1"}),(t=e.created_at,new Date(t).toLocaleDateString("sk-SK",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}))]}),e.changed_by&&N.jsxs("div",{className:"flex items-center",children:[N.jsx(oe,{className:"mr-1"}),"Admin"]})]}),e.notes&&N.jsxs("div",{className:"mt-2 p-2 bg-slate-50 rounded text-sm",children:[N.jsxs("div",{className:"flex items-center text-slate-600 mb-1",children:[N.jsx(ae,{className:"mr-1 text-xs"}),"Poznámka:"]}),N.jsx("p",{className:"text-slate-700",children:e.notes})]})]})]},e.id);var t}):N.jsx("div",{className:"text-center py-6 text-slate-500",children:N.jsx("p",{className:"text-sm",children:"Zatiaľ žiadna história zmien"})})})]})}function je(){const s=a(),[t,r]=e.useState(!0),[i,n]=e.useState([]),[c,o]=e.useState(null),[d,x]=e.useState(null),[m,h]=e.useState(null);e.useEffect(()=>{(async()=>{try{const{data:{user:e}}=await C.auth.getUser();if(!e)return void s("/");x(e),await u(e.id)}catch(e){console.error("Error fetching user:",e),o("Chyba pri načítavaní používateľských dát.")}finally{r(!1)}})()},[s]);const u=async e=>{try{const{data:s,error:t}=await C.from("user_sales").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(t)throw t;n(s||[])}catch(s){console.error("Error fetching sales:",s),o("Chyba pri načítavaní vašich predajov.")}};if(t)return N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100 flex items-center justify-center",children:N.jsxs("div",{className:"text-center",children:[N.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-white rounded-xl shadow-lg mb-3",children:N.jsxs("svg",{className:"animate-spin h-6 w-6 text-slate-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),N.jsx("p",{className:"text-lg text-slate-600",children:"Načítavajú sa predaje..."})]})});const p=i.reduce((e,s)=>e+s.payout,0),b=i.filter(e=>"completed"===e.status).length;return N.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100",children:[N.jsx("header",{className:"bg-white/80 backdrop-blur-sm border-b border-slate-200/50 sticky top-0 z-40",children:N.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-gradient-to-br from-slate-900 to-slate-700 rounded-xl",children:N.jsx(se,{className:"text-white text-lg"})}),N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Moje predaje"}),N.jsx("p",{className:"text-sm text-slate-600",children:"História vašich predajov"})]})]}),N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsxs(l,{to:"/dashboard",className:"inline-flex items-center px-4 py-2 bg-white text-slate-700 font-semibold rounded-xl hover:bg-slate-50 transition-all duration-200 border border-slate-200 shadow-sm",children:[N.jsx(E,{className:"mr-2 text-sm"}),"Späť na Dashboard"]}),N.jsxs(l,{to:"/profile",className:"inline-flex items-center px-4 py-2 bg-white text-slate-700 font-semibold rounded-xl hover:bg-slate-50 transition-all duration-200 border border-slate-200 shadow-sm",children:[N.jsx(oe,{className:"mr-2 text-sm"}),"Profil"]}),N.jsxs("button",{onClick:async()=>{try{await C.auth.signOut(),s("/")}catch(e){console.error("Error signing out:",e)}},className:"inline-flex items-center px-4 py-2 bg-red-50 text-red-600 font-semibold rounded-xl hover:bg-red-100 transition-all duration-200 border border-red-200",children:[N.jsx(te,{className:"mr-2 text-sm"}),"Odhlásiť"]})]})]})})}),N.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c&&N.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-xl p-4",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx(I,{className:"h-5 w-5 text-red-400"})}),N.jsx("div",{className:"ml-3",children:N.jsx("p",{className:"text-sm text-red-800",children:c})})]}),N.jsxs("div",{className:"flex space-x-2",children:[N.jsx("button",{onClick:()=>{o(null),d&&u(d.id)},className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Skúsiť znova"}),N.jsx("button",{onClick:()=>o(null),className:"text-red-400 hover:text-red-600",children:N.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})}),N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[N.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-lg",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:N.jsx(se,{className:"text-blue-600 text-xl"})})}),N.jsxs("div",{className:"ml-4",children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Celkový počet predajov"}),N.jsx("p",{className:"text-2xl font-bold text-slate-900",children:i.length})]})]})}),N.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-lg",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:N.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})})}),N.jsxs("div",{className:"ml-4",children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Celkový payout"}),N.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[p.toFixed(2)," €"]})]})]})}),N.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-lg",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:N.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),N.jsxs("div",{className:"ml-4",children:[N.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Dokončené predaje"}),N.jsx("p",{className:"text-2xl font-bold text-slate-900",children:b})]})]})})]}),N.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-white/20 shadow-lg overflow-hidden",children:[N.jsxs("div",{className:"px-6 py-4 border-b border-slate-200",children:[N.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"História predajov"}),N.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Prehľad všetkých vašich predajov"})]}),i.length>0?N.jsx("div",{className:"overflow-x-auto",children:N.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[N.jsx("thead",{className:"bg-slate-50/50",children:N.jsxs("tr",{children:[N.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Produkt"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Veľkosť"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Cena"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Výplata"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Status"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Dátum"})]})}),N.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:i.map(e=>{return N.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors",children:[N.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"h-16 w-16 flex-shrink-0 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-sm",children:N.jsx("img",{className:"h-full w-full object-contain p-2",src:e.image_url||"/default-image.png",alt:e.name,onError:e=>{e.target.src="/default-image.png"}})}),N.jsx("div",{className:"ml-4",children:N.jsx("div",{className:"text-sm font-semibold text-slate-900",children:e.name})})]})}),N.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-slate-100 text-slate-800",children:e.size})}),N.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-slate-900",children:[e.price," €"]}),N.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-green-600",children:[e.payout.toFixed(2)," €"]}),N.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N.jsxs("div",{className:"flex items-center space-x-2",children:[N.jsx(be,{status:e.status}),N.jsx("button",{onClick:()=>h(e),className:"text-blue-600 hover:text-blue-800 text-xs underline",children:"História"})]})}),N.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-500",children:(s=e.created_at,new Date(s).toLocaleDateString("sk-SK",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}))})]},e.id);var s})})]})}):N.jsxs("div",{className:"text-center py-12",children:[N.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:N.jsx(se,{className:"text-slate-400 text-2xl"})}),N.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Žiadne predaje"}),N.jsx("p",{className:"text-slate-600 mb-6",children:"Zatiaľ nemáte žiadne predaje"}),N.jsxs(l,{to:"/dashboard",className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-slate-900 to-slate-700 text-white font-semibold rounded-xl hover:from-slate-800 hover:to-slate-600 transition-all duration-200 transform hover:scale-105",children:[N.jsx(E,{className:"mr-2"}),"Späť na Dashboard"]})]})]}),m&&N.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:N.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[N.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[N.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Status predaja"}),N.jsx("button",{onClick:()=>h(null),className:"p-2 hover:bg-slate-100 rounded-xl transition-colors",children:N.jsx("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),N.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:[N.jsx("div",{className:"bg-slate-50 rounded-xl p-4 mb-6",children:N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx("div",{className:"h-16 w-16 flex-shrink-0 overflow-hidden rounded-xl border border-slate-200 bg-white",children:N.jsx("img",{src:m.image_url||"/default-image.png",alt:m.name,className:"h-full w-full object-contain p-2"})}),N.jsxs("div",{children:[N.jsx("h3",{className:"font-semibold text-slate-900 text-lg",children:m.name}),N.jsxs("p",{className:"text-slate-600",children:["Veľkosť: ",m.size]}),N.jsxs("p",{className:"text-slate-600",children:["Cena: ",m.price," €"]}),N.jsxs("p",{className:"text-slate-600",children:["Výplata: ",m.payout.toFixed(2)," €"]})]})]})}),N.jsx(fe,{saleId:m.id,currentStatus:m.status})]})]})})]})]})}function ve(){const s=r(),[t,a]=e.useState(!0),[i,n]=e.useState({totalUsers:0,totalProducts:0,totalListings:0,totalSales:0,totalRevenue:0,totalPayout:0,recentActivity:0}),[c,o]=e.useState(null),d=e.useCallback(async()=>{try{a(!0),o(null);const e=[C.from("profiles").select("id",{count:"exact"}),C.from("products").select("id",{count:"exact"}),C.from("user_products").select("id, price, payout",{count:"exact"}),C.from("user_sales").select("id, price, payout",{count:"exact"})],s=await Promise.allSettled(e),[t,l,r,i]=s,c="fulfilled"===t.status&&t.value.count||0,d="fulfilled"===l.status&&l.value.count||0,x="fulfilled"===r.status&&r.value.count||0,m="fulfilled"===i.status&&i.value.count||0,h="fulfilled"===i.status&&i.value.data?i.value.data.reduce((e,s)=>e+(s.price||0),0):0,u="fulfilled"===i.status&&i.value.data?i.value.data.reduce((e,s)=>e+(s.payout||0),0):0;n({totalUsers:c,totalProducts:d,totalListings:x,totalSales:m,totalRevenue:h,totalPayout:u,recentActivity:Math.floor(50*Math.random())+10})}catch(e){console.error("Error loading stats:",e.message),o("Chyba pri načítavaní štatistík: "+e.message)}finally{a(!1)}},[]),x=e=>new Intl.NumberFormat("sk-SK",{style:"currency",currency:"EUR"}).format(e);return e.useEffect(()=>{d()},[d]),t?N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center",children:N.jsxs("div",{className:"text-center",children:[N.jsx("div",{className:"w-12 h-12 border-4 border-slate-600 border-t-blue-500 rounded-full animate-spin mx-auto mb-4"}),N.jsx("h3",{className:"text-lg font-semibold text-white",children:"Načítava sa admin dashboard"})]})}):N.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[N.jsx("header",{className:"bg-slate-800/50 backdrop-blur-xl border-b border-slate-700/50 sticky top-0 z-50",children:N.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsxs("div",{className:"relative",children:[N.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-blue-600 via-purple-600 to-blue-800 rounded-2xl shadow-lg",children:N.jsx(ce,{className:"text-white text-xl"})}),N.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-slate-800 animate-pulse"})]}),N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Admin Dashboard"}),N.jsx("p",{className:"text-sm text-slate-400",children:"Správa systému a analýza dát"})]})]}),N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsxs(l,{to:"/dashboard",className:"inline-flex items-center px-4 py-2 bg-slate-700/50 text-slate-300 font-semibold rounded-xl hover:bg-slate-600/50 transition-all duration-200 border border-slate-600/50 backdrop-blur-sm",children:[N.jsx(E,{className:"mr-2 text-sm"}),"Dashboard"]}),N.jsxs("button",{onClick:async()=>{try{await C.auth.signOut(),window.location.href="/"}catch(e){console.error("Error signing out:",e.message)}},className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-red-600 to-red-700 text-white font-semibold rounded-xl hover:from-red-700 hover:to-red-800 transition-all duration-200 shadow-lg transform hover:scale-105",children:[N.jsx(te,{className:"mr-2 text-sm"}),"Odhlásiť"]})]})]})})}),N.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[N.jsx("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl border border-slate-700/50 shadow-2xl mb-8 overflow-hidden",children:N.jsx("div",{className:"flex overflow-x-auto",children:[{id:"overview",label:"Prehľad",icon:H,color:"from-blue-500 to-cyan-500",path:"/admin"},{id:"products",label:"Produkty",icon:ee,color:"from-purple-500 to-violet-500",path:"/admin/products"},{id:"listed-products",label:"Ponuky",icon:W,color:"from-orange-500 to-amber-500",path:"/admin/listed-products"},{id:"sales",label:"Predaje",icon:se,color:"from-green-500 to-emerald-500",path:"/admin/sales"},{id:"users",label:"Užívatelia",icon:de,color:"from-indigo-500 to-blue-500",path:"/admin/users"},{id:"settings",label:"Nastavenia",icon:F,color:"from-gray-500 to-slate-500",path:"/admin/settings"}].map(e=>{const t=s.pathname===e.path;return N.jsxs(l,{to:e.path,className:"relative flex items-center px-6 py-4 font-semibold transition-all duration-300 min-w-max "+(t?"text-white":"text-slate-400 hover:text-white hover:bg-slate-700/30"),children:[t&&N.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${e.color} opacity-20 rounded-lg`}),N.jsx(e.icon,{className:"mr-2 text-sm "+(t?`text-transparent bg-gradient-to-r ${e.color} bg-clip-text`:"")}),N.jsx("span",{className:t?`bg-gradient-to-r ${e.color} bg-clip-text text-transparent font-bold`:"",children:e.label}),t&&N.jsx("div",{className:`absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r ${e.color} rounded-full`})]},e.id)})})}),N.jsxs("div",{className:"space-y-8",children:[N.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{title:"Používatelia",value:i.totalUsers,icon:de,color:"from-green-500 to-emerald-500"},{title:"Produkty",value:i.totalProducts,icon:ee,color:"from-purple-500 to-violet-500"},{title:"Aktívne ponuky",value:i.totalListings,icon:q,color:"from-orange-500 to-amber-500"},{title:"Predaje",value:i.totalSales,icon:B,color:"from-blue-500 to-cyan-500"}].map((e,s)=>N.jsx("div",{className:"relative group",children:N.jsx("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl p-6 border border-slate-700/50 hover:border-slate-600/50 transition-all duration-300 transform hover:scale-105 hover:shadow-2xl",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm font-medium",children:e.title}),N.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:e.value.toLocaleString()})]}),N.jsx("div",{className:`w-16 h-16 rounded-2xl bg-gradient-to-br ${e.color} flex items-center justify-center shadow-lg`,children:N.jsx(e.icon,{className:"text-white text-2xl"})})]})})},s))}),N.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[N.jsxs("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl p-6 border border-slate-700/50",children:[N.jsxs("div",{className:"flex items-center justify-between mb-4",children:[N.jsx("h3",{className:"text-xl font-bold text-white",children:"Celkové tržby"}),N.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center",children:N.jsx($,{className:"text-white text-lg"})})]}),N.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-green-400 to-emerald-400 bg-clip-text text-transparent",children:x(i.totalRevenue)}),N.jsx("p",{className:"text-slate-400 text-sm mt-2",children:"Celkové tržby zo všetkých predajov"})]}),N.jsxs("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl p-6 border border-slate-700/50",children:[N.jsxs("div",{className:"flex items-center justify-between mb-4",children:[N.jsx("h3",{className:"text-xl font-bold text-white",children:"Celkové výplaty"}),N.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center",children:N.jsx(B,{className:"text-white text-lg"})})]}),N.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent",children:x(i.totalPayout)}),N.jsx("p",{className:"text-slate-400 text-sm mt-2",children:"Celkové výplaty pre predajcov"})]})]}),N.jsxs("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl border border-slate-700/50 overflow-hidden",children:[N.jsx("div",{className:"px-6 py-4 border-b border-slate-700/50",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsx("h3",{className:"text-xl font-bold text-white",children:"Nedávna aktivita"}),N.jsxs("div",{className:"flex items-center space-x-2",children:[N.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),N.jsx("span",{className:"text-sm text-slate-400",children:"Live"})]})]})}),N.jsx("div",{className:"p-6",children:N.jsx("div",{className:"space-y-4",children:[{action:"Nový používateľ sa zaregistroval",time:"2 min",icon:de,color:"text-blue-400"},{action:"Produkt bol pridaný do ponuky",time:"5 min",icon:Y,color:"text-green-400"},{action:"Predaj bol dokončený",time:"12 min",icon:B,color:"text-purple-400"},{action:"Nový produkt v katalógu",time:"1 hod",icon:ee,color:"text-orange-400"}].map((e,s)=>N.jsxs("div",{className:"flex items-center space-x-4 p-3 rounded-xl hover:bg-slate-700/30 transition-colors",children:[N.jsx("div",{className:`w-10 h-10 rounded-xl bg-slate-700/50 flex items-center justify-center ${e.color}`,children:N.jsx(e.icon,{className:"text-sm"})}),N.jsxs("div",{className:"flex-1",children:[N.jsx("p",{className:"text-white text-sm font-medium",children:e.action}),N.jsxs("p",{className:"text-slate-400 text-xs",children:["pred ",e.time]})]})]},s))})})]})]})]})]})}function ge(){const s=r(),[t,a]=e.useState([]),[i,n]=e.useState(!0),[c,o]=e.useState(null),[d,x]=e.useState(""),[m,h]=e.useState(!1),u=e.useCallback(async()=>{try{o(null),m||n(!0);const{data:e,error:s}=await C.from("products").select("id, name, image_url, sku").order("name",{ascending:!0});if(s)throw s;a(e||[])}catch(e){console.error("Error loading products:",e.message),o("Chyba pri načítavaní produktov: "+e.message)}finally{n(!1),h(!1)}},[m]);e.useEffect(()=>{u()},[]);const p=t.filter(e=>[e.name,e.sku].some(e=>e?.toLowerCase().includes(d.toLowerCase())));return i?N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center",children:N.jsxs("div",{className:"text-center",children:[N.jsx("div",{className:"w-12 h-12 border-4 border-slate-600 border-t-purple-500 rounded-full animate-spin mx-auto mb-4"}),N.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Načítavajú sa produkty"}),N.jsx("p",{className:"text-sm text-slate-400",children:"Prosím čakajte..."})]})}):N.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[N.jsx("header",{className:"bg-slate-800/50 backdrop-blur-xl border-b border-slate-700/50 sticky top-0 z-50",children:N.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsxs("div",{className:"relative",children:[N.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-purple-600 via-violet-600 to-purple-800 rounded-2xl shadow-lg",children:N.jsx(ee,{className:"text-white text-xl"})}),N.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-slate-800 animate-pulse"})]}),N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-purple-400 to-violet-400 bg-clip-text text-transparent",children:"Správa produktov"}),N.jsx("p",{className:"text-sm text-slate-400",children:"Katalóg a správa produktov"})]})]}),N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsxs("button",{onClick:async()=>{h(!0),await u()},disabled:m,className:"inline-flex items-center px-4 py-2 bg-slate-700/50 text-slate-300 font-semibold rounded-xl hover:bg-slate-600/50 transition-all duration-200 border border-slate-600/50 backdrop-blur-sm disabled:opacity-50",children:[N.jsx(re,{className:"mr-2 text-sm "+(m?"animate-spin":"")}),m?"Obnovuje sa...":"Refresh"]}),N.jsxs("button",{onClick:async()=>{try{await C.auth.signOut(),window.location.href="/"}catch(e){console.error("Error signing out:",e.message)}},className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-red-600 to-red-700 text-white font-semibold rounded-xl hover:from-red-700 hover:to-red-800 transition-all duration-200 shadow-lg transform hover:scale-105",children:[N.jsx(te,{className:"mr-2 text-sm"}),"Odhlásiť"]})]})]})})}),N.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c&&N.jsx("div",{className:"mb-6 bg-red-900/20 border border-red-500/30 rounded-xl p-4 backdrop-blur-sm",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx(I,{className:"h-5 w-5 text-red-400"}),N.jsx("p",{className:"ml-3 text-sm text-red-300",children:c})]}),N.jsxs("div",{className:"flex space-x-2",children:[N.jsx("button",{onClick:()=>{o(null),u()},className:"text-red-300 hover:text-red-100 text-sm font-medium",children:"Skúsiť znova"}),N.jsx("button",{onClick:()=>o(null),className:"text-red-400 hover:text-red-300",children:N.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})}),N.jsx("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl border border-slate-700/50 shadow-2xl mb-8 overflow-hidden",children:N.jsx("div",{className:"flex overflow-x-auto",children:[{id:"overview",label:"Prehľad",icon:H,color:"from-blue-500 to-cyan-500",path:"/admin"},{id:"products",label:"Produkty",icon:ee,color:"from-purple-500 to-violet-500",path:"/admin/products"},{id:"listed-products",label:"Ponuky",icon:W,color:"from-orange-500 to-amber-500",path:"/admin/listed-products"},{id:"sales",label:"Predaje",icon:se,color:"from-green-500 to-emerald-500",path:"/admin/sales"},{id:"users",label:"Užívatelia",icon:de,color:"from-indigo-500 to-blue-500",path:"/admin/users"},{id:"settings",label:"Nastavenia",icon:F,color:"from-gray-500 to-slate-500",path:"/admin/settings"}].map(e=>{const t=s.pathname===e.path;return N.jsxs(l,{to:e.path,className:"relative flex items-center px-6 py-4 font-semibold transition-all duration-300 min-w-max "+(t?"text-white":"text-slate-400 hover:text-white hover:bg-slate-700/30"),children:[t&&N.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${e.color} opacity-20 rounded-lg`}),N.jsx(e.icon,{className:"mr-2 text-sm "+(t?`text-transparent bg-gradient-to-r ${e.color} bg-clip-text`:"")}),N.jsx("span",{className:t?`bg-gradient-to-r ${e.color} bg-clip-text text-transparent font-bold`:"",children:e.label}),t&&N.jsx("div",{className:`absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r ${e.color} rounded-full`})]},e.id)})})}),N.jsxs("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl border border-slate-700/50 shadow-2xl overflow-hidden",children:[N.jsx("div",{className:"px-6 py-4 border-b border-slate-700/50 bg-slate-800/50",children:N.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[N.jsxs("div",{children:[N.jsxs("h3",{className:"text-xl font-bold text-white",children:["Produkty (",p.length,")"]}),N.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Správa a prehľad produktov"})]}),N.jsx("div",{className:"flex items-center space-x-3",children:N.jsxs("div",{className:"relative",children:[N.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 text-sm"}),N.jsx("input",{type:"text",placeholder:"Vyhľadať produkty...",value:d,onChange:e=>x(e.target.value),className:"pl-10 pr-4 py-2 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-transparent transition-all duration-200"})]})})]})}),N.jsx("div",{className:"overflow-x-auto",children:N.jsxs("table",{className:"min-w-full divide-y divide-slate-700/50",children:[N.jsx("thead",{className:"bg-slate-800/50",children:N.jsxs("tr",{children:[N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"ID"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"IMAGE"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Názov"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"SKU"})]})}),N.jsx("tbody",{className:"divide-y divide-slate-700/30",children:p.map(e=>N.jsxs("tr",{className:"hover:bg-slate-700/20 transition-colors",children:[N.jsx("td",{className:"px-6 py-4 text-sm text-slate-300 font-mono",children:e.id}),N.jsx("td",{className:"px-6 py-4",children:N.jsx("div",{className:"h-20 w-20 flex-shrink-0 overflow-hidden rounded-xl border border-gray-200 bg-white p-2 shadow-sm",children:N.jsx("img",{className:"h-full w-full object-contain",src:e.image_url||"/default-image.png",alt:e.name,onError:e=>{e.target.src="/default-image.png"}})})}),N.jsx("td",{className:"px-6 py-4 text-sm font-semibold text-white",children:e.name}),N.jsx("td",{className:"px-6 py-4 text-sm text-slate-300 font-mono",children:e.sku})]},e.id))})]})}),0===p.length&&N.jsxs("div",{className:"text-center py-12",children:[N.jsx("div",{className:"w-16 h-16 bg-slate-700/30 rounded-2xl flex items-center justify-center mx-auto mb-4",children:N.jsx(ee,{className:"text-slate-400 text-2xl"})}),N.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Žiadne produkty"}),N.jsx("p",{className:"text-slate-400",children:d?"Nenašli sa žiadne produkty pre váš vyhľadávací výraz":"Zatiaľ nie sú pridané žiadne produkty"})]})]})]})]})}function Ne(){const s=r(),[t,a]=e.useState([]),[i,n]=e.useState(!0),[c,o]=e.useState(null),[d,x]=e.useState(""),[m,h]=e.useState(null),[u,p]=e.useState([]),[b,f]=e.useState([]),[j,v]=e.useState(null),[g,w]=e.useState(!1),[y,k]=e.useState(!1),[_,z]=e.useState("info"),S=e.useCallback(async()=>{try{o(null),g||n(!0);const{data:e,error:s}=await C.from("profiles").select("\n          id, first_name, last_name, profile_type, vat_type, company_name, vat_number, \n          address, popisne_cislo, psc, mesto, krajina, email, telephone, iban, ico\n        ").limit(100);if(s)throw s;a(e||[])}catch(e){console.error("Error loading users:",e.message),o("Chyba pri načítavaní užívateľov: "+e.message)}finally{n(!1),w(!1)}},[g]),P=async e=>{h(e),z("info"),await(async e=>{try{k(!0);const{data:s,error:t}=await C.from("user_sales").select("id, product_id, name, size, price, payout, created_at, status, image_url, sku, external_id").eq("user_id",e).order("created_at",{ascending:!1});if(t)throw t;p(s||[]);const{data:a,error:l}=await C.from("user_products").select("id, product_id, name, size, price, payout, created_at, image_url, sku").eq("user_id",e).order("created_at",{ascending:!1});if(l)throw l;f(a||[]);const r=s||[],i=a||[],n={totalSales:r.length,totalRevenue:r.reduce((e,s)=>e+s.price,0),totalPayout:r.reduce((e,s)=>e+s.payout,0),totalProducts:i.length,completedSales:r.filter(e=>"completed"===e.status).length,pendingSales:r.filter(e=>["accepted","processing","shipped"].includes(e.status)).length};v(n)}catch(s){console.error("Error loading user details:",s.message),o("Chyba pri načítavaní detailov užívateľa: "+s.message)}finally{k(!1)}})(e.id)},L=e=>new Date(e).toLocaleDateString("sk-SK",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),M=e=>new Intl.NumberFormat("sk-SK",{style:"currency",currency:"EUR"}).format(e);e.useEffect(()=>{S()},[]);const E=t.filter(e=>[e.email,e.first_name,e.last_name].some(e=>e?.toLowerCase().includes(d.toLowerCase())));return i?N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center",children:N.jsxs("div",{className:"text-center",children:[N.jsx("div",{className:"w-12 h-12 border-4 border-slate-600 border-t-indigo-500 rounded-full animate-spin mx-auto mb-4"}),N.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Načítavajú sa užívatelia"}),N.jsx("p",{className:"text-sm text-slate-400",children:"Prosím čakajte..."})]})}):N.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[N.jsx("header",{className:"bg-slate-800/50 backdrop-blur-xl border-b border-slate-700/50 sticky top-0 z-50",children:N.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsxs("div",{className:"relative",children:[N.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-indigo-600 via-blue-600 to-indigo-800 rounded-2xl shadow-lg",children:N.jsx(de,{className:"text-white text-xl"})}),N.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-slate-800 animate-pulse"})]}),N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-indigo-400 to-blue-400 bg-clip-text text-transparent",children:"Správa užívateľov"}),N.jsx("p",{className:"text-sm text-slate-400",children:"Katalóg a správa užívateľov"})]})]}),N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsxs("button",{onClick:async()=>{w(!0),await S()},disabled:g,className:"inline-flex items-center px-4 py-2 bg-slate-700/50 text-slate-300 font-semibold rounded-xl hover:bg-slate-600/50 transition-all duration-200 border border-slate-600/50 backdrop-blur-sm disabled:opacity-50",children:[N.jsx(re,{className:"mr-2 text-sm "+(g?"animate-spin":"")}),g?"Obnovuje sa...":"Refresh"]}),N.jsxs("button",{onClick:async()=>{try{await C.auth.signOut(),window.location.href="/"}catch(e){console.error("Error signing out:",e.message)}},className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-red-600 to-red-700 text-white font-semibold rounded-xl hover:from-red-700 hover:to-red-800 transition-all duration-200 shadow-lg transform hover:scale-105",children:[N.jsx(te,{className:"mr-2 text-sm"}),"Odhlásiť"]})]})]})})}),N.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c&&N.jsx("div",{className:"mb-6 bg-red-900/20 border border-red-500/30 rounded-xl p-4 backdrop-blur-sm",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx(I,{className:"h-5 w-5 text-red-400"}),N.jsx("p",{className:"ml-3 text-sm text-red-300",children:c})]}),N.jsxs("div",{className:"flex space-x-2",children:[N.jsx("button",{onClick:()=>{o(null),S()},className:"text-red-300 hover:text-red-100 text-sm font-medium",children:"Skúsiť znova"}),N.jsx("button",{onClick:()=>o(null),className:"text-red-400 hover:text-red-300",children:N.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})}),N.jsx("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl border border-slate-700/50 shadow-2xl mb-8 overflow-hidden",children:N.jsx("div",{className:"flex overflow-x-auto",children:[{id:"overview",label:"Prehľad",icon:H,color:"from-blue-500 to-cyan-500",path:"/admin"},{id:"products",label:"Produkty",icon:ee,color:"from-purple-500 to-violet-500",path:"/admin/products"},{id:"listed-products",label:"Ponuky",icon:W,color:"from-orange-500 to-amber-500",path:"/admin/listed-products"},{id:"sales",label:"Predaje",icon:se,color:"from-green-500 to-emerald-500",path:"/admin/sales"},{id:"users",label:"Užívatelia",icon:de,color:"from-indigo-500 to-blue-500",path:"/admin/users"},{id:"settings",label:"Nastavenia",icon:F,color:"from-gray-500 to-slate-500",path:"/admin/settings"}].map(e=>{const t=s.pathname===e.path;return N.jsxs(l,{to:e.path,className:"relative flex items-center px-6 py-4 font-semibold transition-all duration-300 min-w-max "+(t?"text-white":"text-slate-400 hover:text-white hover:bg-slate-700/30"),children:[t&&N.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${e.color} opacity-20 rounded-lg`}),N.jsx(e.icon,{className:"mr-2 text-sm "+(t?`text-transparent bg-gradient-to-r ${e.color} bg-clip-text`:"")}),N.jsx("span",{className:t?`bg-gradient-to-r ${e.color} bg-clip-text text-transparent font-bold`:"",children:e.label}),t&&N.jsx("div",{className:`absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r ${e.color} rounded-full`})]},e.id)})})}),N.jsxs("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl border border-slate-700/50 shadow-2xl overflow-hidden",children:[N.jsx("div",{className:"px-6 py-4 border-b border-slate-700/50 bg-slate-800/50",children:N.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[N.jsxs("div",{children:[N.jsxs("h3",{className:"text-xl font-bold text-white",children:["Užívatelia (",E.length,")"]}),N.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Správa a prehľad užívateľov"})]}),N.jsx("div",{className:"flex items-center space-x-3",children:N.jsxs("div",{className:"relative",children:[N.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 text-sm"}),N.jsx("input",{type:"text",placeholder:"Vyhľadať užívateľov...",value:d,onChange:e=>x(e.target.value),className:"pl-10 pr-4 py-2 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-transparent transition-all duration-200"})]})})]})}),N.jsx("div",{className:"overflow-x-auto",children:N.jsxs("table",{className:"min-w-full divide-y divide-slate-700/50",children:[N.jsx("thead",{className:"bg-slate-800/50",children:N.jsxs("tr",{children:[N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"ID"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Email"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Meno"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Typ"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Akcie"})]})}),N.jsx("tbody",{className:"divide-y divide-slate-700/30",children:E.map(e=>N.jsxs("tr",{className:"hover:bg-slate-700/20 transition-colors",children:[N.jsxs("td",{className:"px-6 py-4 text-sm text-slate-300 font-mono",children:[e.id.slice(0,8),"..."]}),N.jsx("td",{className:"px-6 py-4 text-sm text-white",children:e.email}),N.jsx("td",{className:"px-6 py-4 text-sm text-slate-300",children:e.first_name||e.last_name?`${e.first_name||""} ${e.last_name||""}`.trim():"N/A"}),N.jsx("td",{className:"px-6 py-4 text-sm text-slate-300",children:N.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+("Obchodný"===e.profile_type?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.profile_type||"N/A"})}),N.jsx("td",{className:"px-6 py-4",children:N.jsxs("button",{onClick:()=>P(e),className:"inline-flex items-center px-3 py-2 bg-gradient-to-r from-indigo-600 to-blue-600 text-white text-sm font-semibold rounded-xl hover:from-indigo-700 hover:to-blue-700 transition-all duration-200 shadow-sm",children:[N.jsx(K,{className:"mr-2 text-xs"}),"Detail"]})})]},e.id))})]})}),0===E.length&&N.jsxs("div",{className:"text-center py-12",children:[N.jsx("div",{className:"w-16 h-16 bg-slate-700/30 rounded-2xl flex items-center justify-center mx-auto mb-4",children:N.jsx(de,{className:"text-slate-400 text-2xl"})}),N.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Žiadni užívatelia"}),N.jsx("p",{className:"text-slate-400",children:d?"Nenašli sa žiadni užívatelia pre váš vyhľadávací výraz":"Zatiaľ nie sú pridaní žiadni užívatelia"})]})]}),m&&N.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:N.jsxs("div",{className:"bg-slate-800/95 backdrop-blur-xl rounded-2xl w-full max-w-6xl border border-slate-700/50 max-h-[95vh] overflow-hidden",children:[N.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-700/50 bg-slate-800/50",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-indigo-600 to-blue-600 rounded-xl flex items-center justify-center",children:N.jsx(oe,{className:"text-white text-xl"})}),N.jsxs("div",{children:[N.jsx("h3",{className:"text-xl font-bold text-white",children:m.first_name||m.last_name?`${m.first_name||""} ${m.last_name||""}`.trim():"Užívateľ"}),N.jsx("p",{className:"text-slate-400 text-sm",children:m.email})]})]}),N.jsx("button",{onClick:()=>{h(null),p([]),f([]),v(null)},className:"p-2 text-slate-400 hover:text-white hover:bg-slate-700/50 rounded-xl transition-colors",children:N.jsx(ie,{className:"text-xl"})})]}),j&&N.jsx("div",{className:"p-6 border-b border-slate-700/50 bg-slate-800/30",children:N.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[N.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4 text-center",children:[N.jsx("div",{className:"w-8 h-8 bg-blue-500/20 rounded-lg flex items-center justify-center mx-auto mb-2",children:N.jsx(se,{className:"text-blue-400 text-sm"})}),N.jsx("p",{className:"text-2xl font-bold text-white",children:j.totalSales}),N.jsx("p",{className:"text-xs text-slate-400",children:"Predaje"})]}),N.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4 text-center",children:[N.jsx("div",{className:"w-8 h-8 bg-green-500/20 rounded-lg flex items-center justify-center mx-auto mb-2",children:N.jsx($,{className:"text-green-400 text-sm"})}),N.jsx("p",{className:"text-2xl font-bold text-white",children:M(j.totalRevenue)}),N.jsx("p",{className:"text-xs text-slate-400",children:"Tržby"})]}),N.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4 text-center",children:[N.jsx("div",{className:"w-8 h-8 bg-purple-500/20 rounded-lg flex items-center justify-center mx-auto mb-2",children:N.jsx(B,{className:"text-purple-400 text-sm"})}),N.jsx("p",{className:"text-2xl font-bold text-white",children:M(j.totalPayout)}),N.jsx("p",{className:"text-xs text-slate-400",children:"Payout"})]}),N.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4 text-center",children:[N.jsx("div",{className:"w-8 h-8 bg-orange-500/20 rounded-lg flex items-center justify-center mx-auto mb-2",children:N.jsx(V,{className:"text-orange-400 text-sm"})}),N.jsx("p",{className:"text-2xl font-bold text-white",children:j.totalProducts}),N.jsx("p",{className:"text-xs text-slate-400",children:"Produkty"})]}),N.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4 text-center",children:[N.jsx("div",{className:"w-8 h-8 bg-green-500/20 rounded-lg flex items-center justify-center mx-auto mb-2",children:N.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),N.jsx("p",{className:"text-2xl font-bold text-white",children:j.completedSales}),N.jsx("p",{className:"text-xs text-slate-400",children:"Dokončené"})]}),N.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4 text-center",children:[N.jsx("div",{className:"w-8 h-8 bg-yellow-500/20 rounded-lg flex items-center justify-center mx-auto mb-2",children:N.jsx("svg",{className:"w-4 h-4 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),N.jsx("p",{className:"text-2xl font-bold text-white",children:j.pendingSales}),N.jsx("p",{className:"text-xs text-slate-400",children:"Čakajúce"})]})]})}),N.jsx("div",{className:"flex border-b border-slate-700/50 bg-slate-800/30",children:[{id:"info",label:"Informácie",icon:oe},{id:"sales",label:"Predaje",icon:se},{id:"products",label:"Produkty",icon:V}].map(e=>N.jsxs("button",{onClick:()=>z(e.id),className:"flex items-center px-6 py-4 font-semibold transition-all duration-200 "+(_===e.id?"text-white border-b-2 border-indigo-500 bg-slate-700/30":"text-slate-400 hover:text-white hover:bg-slate-700/20"),children:[N.jsx(e.icon,{className:"mr-2 text-sm"}),e.label]},e.id))}),N.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:y?N.jsxs("div",{className:"flex items-center justify-center py-12",children:[N.jsx("div",{className:"w-8 h-8 border-4 border-slate-600 border-t-indigo-500 rounded-full animate-spin"}),N.jsx("span",{className:"ml-3 text-slate-300",children:"Načítavajú sa údaje..."})]}):N.jsxs(N.Fragment,{children:["info"===_&&N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 text-slate-300",children:[N.jsxs("div",{className:"space-y-4",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx(oe,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Meno"}),N.jsx("p",{className:"font-semibold",children:m.first_name||"N/A"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(oe,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Priezvisko"}),N.jsx("p",{className:"font-semibold",children:m.last_name||"N/A"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(D,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Email"}),N.jsx("p",{className:"font-semibold",children:m.email})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(J,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Telefón"}),N.jsx("p",{className:"font-semibold",children:m.telephone||"N/A"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(A,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Typ profilu"}),N.jsx("p",{className:"font-semibold",children:m.profile_type||"N/A"})]})]}),"Obchodný"===m.profile_type&&N.jsxs(N.Fragment,{children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx(A,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Spoločnosť"}),N.jsx("p",{className:"font-semibold",children:m.company_name||"N/A"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(A,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"IČO"}),N.jsx("p",{className:"font-semibold",children:m.ico||"N/A"})]})]})]})]}),N.jsxs("div",{className:"space-y-4",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx(Z,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Adresa"}),N.jsx("p",{className:"font-semibold",children:m.address||m.popisne_cislo?`${m.address||""} ${m.popisne_cislo||""}`.trim():"N/A"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(Z,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Mesto"}),N.jsx("p",{className:"font-semibold",children:m.mesto||"N/A"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(Z,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"PSČ"}),N.jsx("p",{className:"font-semibold",children:m.psc||"N/A"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(Z,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Krajina"}),N.jsx("p",{className:"font-semibold",children:m.krajina||"N/A"})]})]}),N.jsxs("div",{className:"flex items-center",children:[N.jsx(T,{className:"text-slate-400 mr-3"}),N.jsxs("div",{children:[N.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"IBAN"}),N.jsx("p",{className:"font-semibold font-mono text-sm",children:m.iban||"N/A"})]})]})]})]}),"sales"===_&&N.jsxs("div",{children:[N.jsxs("h4",{className:"text-lg font-semibold text-white mb-4",children:["Predaje (",u.length,")"]}),u.length>0?N.jsx("div",{className:"space-y-4",children:u.map(e=>N.jsx("div",{className:"bg-slate-700/30 rounded-xl p-4 hover:bg-slate-700/40 transition-colors",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx("div",{className:"h-16 w-16 flex-shrink-0 overflow-hidden rounded-xl border border-slate-600 bg-white",children:N.jsx("img",{className:"h-full w-full object-contain p-2",src:e.image_url||"/default-image.png",alt:e.name,onError:e=>{e.target.src="/default-image.png"}})}),N.jsxs("div",{children:[N.jsx("h5",{className:"font-semibold text-white",children:e.name}),N.jsxs("p",{className:"text-sm text-slate-400",children:["Veľkosť: ",e.size]}),N.jsxs("p",{className:"text-sm text-slate-400",children:["SKU: ",e.sku||"N/A"]}),N.jsxs("p",{className:"text-sm text-slate-400",children:["Externé ID: ",e.external_id||"N/A"]})]})]}),N.jsxs("div",{className:"text-right",children:[N.jsx("div",{className:"flex items-center space-x-3 mb-2",children:N.jsx(be,{status:e.status})}),N.jsx("p",{className:"text-lg font-bold text-white",children:M(e.price)}),N.jsxs("p",{className:"text-sm text-green-400",children:["Payout: ",M(e.payout)]}),N.jsx("p",{className:"text-xs text-slate-400",children:L(e.created_at)})]})]})},e.id))}):N.jsxs("div",{className:"text-center py-8",children:[N.jsx(se,{className:"text-slate-400 text-4xl mx-auto mb-4"}),N.jsx("p",{className:"text-slate-400",children:"Žiadne predaje"})]})]}),"products"===_&&N.jsxs("div",{children:[N.jsxs("h4",{className:"text-lg font-semibold text-white mb-4",children:["Produkty (",b.length,")"]}),b.length>0?N.jsx("div",{className:"space-y-4",children:b.map(e=>N.jsx("div",{className:"bg-slate-700/30 rounded-xl p-4 hover:bg-slate-700/40 transition-colors",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx("div",{className:"h-16 w-16 flex-shrink-0 overflow-hidden rounded-xl border border-slate-600 bg-white",children:N.jsx("img",{className:"h-full w-full object-contain p-2",src:e.image_url||"/default-image.png",alt:e.name,onError:e=>{e.target.src="/default-image.png"}})}),N.jsxs("div",{children:[N.jsx("h5",{className:"font-semibold text-white",children:e.name}),N.jsxs("p",{className:"text-sm text-slate-400",children:["Veľkosť: ",e.size]}),N.jsxs("p",{className:"text-sm text-slate-400",children:["SKU: ",e.sku||"N/A"]})]})]}),N.jsxs("div",{className:"text-right",children:[N.jsx("p",{className:"text-lg font-bold text-white",children:M(e.price)}),N.jsxs("p",{className:"text-sm text-green-400",children:["Payout: ",M(e.payout)]}),N.jsx("p",{className:"text-xs text-slate-400",children:L(e.created_at)})]})]})},e.id))}):N.jsxs("div",{className:"text-center py-8",children:[N.jsx(V,{className:"text-slate-400 text-4xl mx-auto mb-4"}),N.jsx("p",{className:"text-slate-400",children:"Žiadne produkty"})]})]})]})})]})})]})]})}function we(){const s=r(),[t,a]=e.useState([]),[i,n]=e.useState(""),[c,o]=e.useState(!1),[d,x]=e.useState(!1),[m,h]=e.useState(""),[u,p]=e.useState(null),b=e.useCallback(async()=>{const{data:e,error:s}=await C.from("user_products").select("\n        id, user_id, product_id, name, size, price, payout, created_at, image_url, sku,\n        profiles(email)\n      ").order("created_at",{ascending:!1});s?console.error("Error loading products:",s.message):a(e?.map(e=>({...e,user_email:e.profiles?.email||"N/A"}))||[])},[]);e.useEffect(()=>{b()},[b]);const f=t.filter(e=>[e.name,e.sku,e.user_email,e.size].some(e=>e?.toLowerCase().includes(i.toLowerCase())));return N.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[N.jsx("header",{className:"bg-slate-800/50 backdrop-blur-xl border-b border-slate-700/50 sticky top-0 z-50",children:N.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsxs("div",{className:"relative",children:[N.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-orange-600 via-amber-600 to-orange-800 rounded-2xl shadow-lg",children:N.jsx(W,{className:"text-white text-xl"})}),N.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-slate-800 animate-pulse"})]}),N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-orange-400 to-amber-400 bg-clip-text text-transparent",children:"Ponuky používateľov"}),N.jsx("p",{className:"text-sm text-slate-400",children:"Správa a prehľad ponúk"})]})]}),N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsxs("button",{onClick:()=>{o(!0),b().finally(()=>o(!1))},className:"inline-flex items-center px-4 py-2 bg-slate-700/50 text-slate-300 font-semibold rounded-xl hover:bg-slate-600/50 border border-slate-600/50 backdrop-blur-sm",children:[N.jsx(re,{className:"mr-2 text-sm "+(c?"animate-spin":"")}),c?"Obnovuje sa...":"Refresh"]}),N.jsxs("button",{onClick:async()=>{await C.auth.signOut(),window.location.href="/"},className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-red-600 to-red-700 text-white font-semibold rounded-xl shadow-lg hover:from-red-700 hover:to-red-800",children:[N.jsx(te,{className:"mr-2 text-sm"}),"Odhlásiť"]})]})]})})}),N.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:N.jsx("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl border border-slate-700/50 shadow-2xl mb-6 overflow-hidden",children:N.jsx("div",{className:"flex overflow-x-auto",children:[{label:"Prehľad",icon:H,path:"/admin"},{label:"Produkty",icon:ee,path:"/admin/products"},{label:"Ponuky",icon:W,path:"/admin/listed-products"},{label:"Predaje",icon:se,path:"/admin/sales"},{label:"Užívatelia",icon:de,path:"/admin/users"},{label:"Nastavenia",icon:F,path:"/admin/settings"}].map(e=>{const t=s.pathname===e.path;return N.jsxs(l,{to:e.path,className:"relative flex items-center px-6 py-4 font-semibold transition-all duration-300 min-w-max "+(t?"text-white":"text-slate-400 hover:text-white hover:bg-slate-700/30"),children:[N.jsx(e.icon,{className:"mr-2 text-sm"}),e.label,t&&N.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-orange-500 to-amber-500 rounded-full"})]},e.path)})})})}),N.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-16",children:N.jsxs("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl border border-slate-700/50 shadow-2xl overflow-hidden",children:[N.jsxs("div",{className:"px-6 py-4 border-b border-slate-700/50 bg-slate-800/50 flex justify-between items-center",children:[N.jsxs("h3",{className:"text-xl font-bold text-white",children:["Ponuky (",f.length,")"]}),N.jsxs("div",{className:"relative",children:[N.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 text-sm"}),N.jsx("input",{type:"text",placeholder:"Vyhľadať...",value:i,onChange:e=>n(e.target.value),className:"pl-10 pr-4 py-2 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-orange-500/50"})]})]}),N.jsxs("div",{className:"overflow-x-auto",children:[N.jsxs("table",{className:"min-w-full divide-y divide-slate-700/50",children:[N.jsx("thead",{className:"bg-slate-800/50",children:N.jsxs("tr",{children:[N.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400",children:"Produkt"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400",children:"Veľkosť"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400",children:"Cena"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400",children:"Payout"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400",children:"Používateľ"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400",children:"SKU"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400",children:"Dátum"}),N.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400",children:"Akcia"})]})}),N.jsx("tbody",{className:"bg-slate-900 divide-y divide-slate-700",children:f.map(e=>N.jsxs("tr",{children:[N.jsxs("td",{className:"px-6 py-4 whitespace-nowrap flex items-center",children:[N.jsx("img",{src:e.image_url||"/default-image.png",alt:"",className:"h-10 w-10 rounded-lg mr-3"}),N.jsxs("div",{children:[N.jsx("div",{className:"text-sm font-medium text-white",children:e.name}),N.jsxs("div",{className:"text-xs text-slate-400",children:["ID: ",e.id.slice(0,8),"..."]})]})]}),N.jsx("td",{className:"px-6 py-4 text-white",children:e.size}),N.jsxs("td",{className:"px-6 py-4 text-white",children:[e.price," €"]}),N.jsxs("td",{className:"px-6 py-4 text-green-400 font-semibold",children:[e.payout.toFixed(2)," €"]}),N.jsx("td",{className:"px-6 py-4 text-slate-300",children:e.user_email}),N.jsx("td",{className:"px-6 py-4 text-slate-300 font-mono",children:e.sku}),N.jsx("td",{className:"px-6 py-4 text-slate-400",children:new Date(e.created_at).toLocaleDateString("sk-SK")}),N.jsx("td",{className:"px-6 py-4",children:N.jsxs("button",{onClick:()=>{p(e),h(""),x(!0)},className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-semibold rounded-xl",children:[N.jsx(O,{className:"mr-2 inline"})," Prijať"]})})]},e.id))})]}),0===f.length&&N.jsx("div",{className:"text-center py-8 text-slate-400",children:"Žiadne ponuky"})]})]})}),d&&u&&N.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:N.jsxs("div",{className:"bg-slate-800 p-6 rounded-2xl shadow-2xl max-w-sm w-full border border-slate-600",children:[N.jsx("h2",{className:"text-lg text-white font-semibold mb-4",children:"Zadaj External ID"}),N.jsx("input",{type:"text",placeholder:"napr. AIR-001",value:m,onChange:e=>h(e.target.value),className:"w-full p-2 rounded bg-slate-700 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-orange-500"}),N.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[N.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 bg-slate-600 text-white rounded hover:bg-slate-700",children:"Zrušiť"}),N.jsx("button",{onClick:async()=>{if(u&&m){o(!0),x(!1);try{const{error:s}=await C.from("user_sales").insert({user_id:u.user_id,product_id:u.product_id,name:u.name,sku:u.sku,size:u.size,price:u.price,payout:u.payout,image_url:u.image_url,status:"accepted",external_id:m});if(s)throw s;const{error:t}=await C.from("user_products").delete().eq("id",u.id);if(t)throw t;if(u.user_email&&"N/A"!==u.user_email)try{await fetch("https://ddzmuxcavpgbzhirzlqt.supabase.co/functions/v1/send-sale-email-ts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u.user_email,productName:u.name,size:u.size,price:u.price,payout:u.payout,external_id:m})})}catch(e){console.warn("Failed to send email:",e)}await b()}catch(s){alert("Chyba pri spracovaní: "+s.message)}finally{o(!1)}}},disabled:!m,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:"Potvrdiť"})]})]})})]})}const ye=[{value:"accepted",label:"Prijatý"},{value:"processing",label:"Spracováva sa"},{value:"shipped",label:"Odoslaný"},{value:"delivered",label:"Doručený"},{value:"completed",label:"Dokončený"},{value:"cancelled",label:"Zrušený"},{value:"returned",label:"Vrátený"}];function ke({saleId:s,currentStatus:t,currentExternalId:a="",onStatusUpdate:l,onExternalIdUpdate:r,onClose:i}){const[n,c]=e.useState(t),[o,d]=e.useState(a),[x,m]=e.useState(""),[h,u]=e.useState(!1),[p,b]=e.useState(null),f=n!==t||o!==a||x.trim();return N.jsxs("div",{className:"space-y-4 p-4 bg-slate-50 rounded-lg border",children:[N.jsx("h4",{className:"text-lg font-semibold text-slate-900",children:"Správa statusu predaja"}),p&&N.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:N.jsx("p",{className:"text-sm text-red-800",children:p})}),N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Aktuálny status:"}),N.jsx(be,{status:t})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Nový status:"}),N.jsx("select",{value:n,onChange:e=>c(e.target.value),className:"block w-full px-3 py-2 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",children:ye.map(e=>N.jsx("option",{value:e.value,children:e.label},e.value))})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Externé ID:"}),N.jsx("input",{type:"text",value:o,onChange:e=>d(e.target.value),placeholder:"Zadajte externé ID...",className:"block w-full px-3 py-2 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),N.jsxs("div",{children:[N.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:[N.jsx(ae,{className:"inline mr-1"}),"Poznámka (voliteľné):"]}),N.jsx("textarea",{value:x,onChange:e=>m(e.target.value),placeholder:"Pridajte poznámku k zmene statusu...",rows:3,className:"block w-full px-3 py-2 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 resize-none"})]}),n!==t&&N.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-green-50 rounded-lg border border-green-200",children:[N.jsx("span",{className:"text-sm font-medium text-green-800",children:"Nový status:"}),N.jsx(be,{status:n})]}),N.jsx("button",{onClick:async()=>{if(n!==t||o!==a||x.trim())try{u(!0),b(null);const{error:e}=await C.from("user_sales").update({status:n,external_id:o||null,status_notes:x.trim()||null,updated_at:(new Date).toISOString()}).eq("id",s);if(e)throw e;l(n),r(o),m(""),i()}catch(e){console.error("Error updating sales status:",e),b("Chyba pri aktualizácii statusu: "+e.message)}finally{u(!1)}},disabled:!f||h,className:"inline-flex items-center px-4 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:h?N.jsxs(N.Fragment,{children:[N.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Ukladá sa..."]}):N.jsxs(N.Fragment,{children:[N.jsx(Q,{className:"mr-2"}),"Uložiť zmeny"]})})]})}function _e(){const s=r(),[t,a]=e.useState([]),[i,n]=e.useState(!0),[c,o]=e.useState(null),[d,x]=e.useState(""),[m,h]=e.useState(!1),[u,p]=e.useState(null),b=e.useCallback(async()=>{try{o(null),m||n(!0);const{data:e,error:s}=await C.from("user_sales").select("\n          id, product_id, name, size, price, payout, created_at, status, image_url, external_id, sku, status_notes,\n          profiles(email)\n        ").order("created_at",{ascending:!1});if(s)throw s;const t=(e||[]).map(e=>({...e,user_email:e.profiles?.email||"N/A"}));a(t)}catch(e){console.error("Error loading sales:",e.message),o("Chyba pri načítavaní predajov: "+e.message)}finally{n(!1),h(!1)}},[m]);e.useEffect(()=>{b()},[]);const f=t.filter(e=>[e.name,e.sku,e.user_email,e.external_id].some(e=>e?.toLowerCase().includes(d.toLowerCase()))),j=t.reduce((e,s)=>e+s.price,0);t.reduce((e,s)=>e+s.payout,0);const v=t.filter(e=>"completed"===e.status).length;return i?N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center",children:N.jsxs("div",{className:"text-center",children:[N.jsx("div",{className:"w-12 h-12 border-4 border-slate-600 border-t-green-500 rounded-full animate-spin mx-auto mb-4"}),N.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Načítavajú sa predaje"}),N.jsx("p",{className:"text-sm text-slate-400",children:"Prosím čakajte..."})]})}):N.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[N.jsx("header",{className:"bg-slate-800/50 backdrop-blur-xl border-b border-slate-700/50 sticky top-0 z-50",children:N.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsxs("div",{className:"relative",children:[N.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-green-600 via-emerald-600 to-green-800 rounded-2xl shadow-lg",children:N.jsx(se,{className:"text-white text-xl"})}),N.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-slate-800 animate-pulse"})]}),N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-green-400 to-emerald-400 bg-clip-text text-transparent",children:"Správa predajov"}),N.jsx("p",{className:"text-sm text-slate-400",children:"Správa a prehľad predaných produktov"})]})]}),N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsxs("button",{onClick:async()=>{h(!0),await b()},disabled:m,className:"inline-flex items-center px-4 py-2 bg-slate-700/50 text-slate-300 font-semibold rounded-xl hover:bg-slate-600/50 transition-all duration-200 border border-slate-600/50 backdrop-blur-sm disabled:opacity-50",children:[N.jsx(re,{className:"mr-2 text-sm "+(m?"animate-spin":"")}),m?"Obnovuje sa...":"Refresh"]}),N.jsxs("button",{onClick:async()=>{try{await C.auth.signOut(),window.location.href="/"}catch(e){console.error("Error signing out:",e.message)}},className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-red-600 to-red-700 text-white font-semibold rounded-xl hover:from-red-700 hover:to-red-800 transition-all duration-200 shadow-lg transform hover:scale-105",children:[N.jsx(te,{className:"mr-2 text-sm"}),"Odhlásiť"]})]})]})})}),N.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c&&N.jsx("div",{className:"mb-6 bg-red-900/20 border border-red-500/30 rounded-xl p-4 backdrop-blur-sm",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx(I,{className:"h-5 w-5 text-red-400"}),N.jsx("p",{className:"ml-3 text-sm text-red-300",children:c})]}),N.jsxs("div",{className:"flex space-x-2",children:[N.jsx("button",{onClick:()=>{o(null),b()},className:"text-red-300 hover:text-red-100 text-sm font-medium",children:"Skúsiť znova"}),N.jsx("button",{onClick:()=>o(null),className:"text-red-400 hover:text-red-300",children:N.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})}),N.jsx("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl border border-slate-700/50 shadow-2xl mb-8 overflow-hidden",children:N.jsx("div",{className:"flex overflow-x-auto",children:[{id:"overview",label:"Prehľad",icon:H,color:"from-blue-500 to-cyan-500",path:"/admin"},{id:"products",label:"Produkty",icon:ee,color:"from-purple-500 to-violet-500",path:"/admin/products"},{id:"listed-products",label:"Ponuky",icon:W,color:"from-orange-500 to-amber-500",path:"/admin/listed-products"},{id:"sales",label:"Predaje",icon:se,color:"from-green-500 to-emerald-500",path:"/admin/sales"},{id:"users",label:"Užívatelia",icon:de,color:"from-indigo-500 to-blue-500",path:"/admin/users"},{id:"settings",label:"Nastavenia",icon:F,color:"from-gray-500 to-slate-500",path:"/admin/settings"}].map(e=>{const t=s.pathname===e.path;return N.jsxs(l,{to:e.path,className:"relative flex items-center px-6 py-4 font-semibold transition-all duration-300 min-w-max "+(t?"text-white":"text-slate-400 hover:text-white hover:bg-slate-700/30"),children:[t&&N.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${e.color} opacity-20 rounded-lg`}),N.jsx(e.icon,{className:"mr-2 text-sm "+(t?`text-transparent bg-gradient-to-r ${e.color} bg-clip-text`:"")}),N.jsx("span",{className:t?`bg-gradient-to-r ${e.color} bg-clip-text text-transparent font-bold`:"",children:e.label}),t&&N.jsx("div",{className:`absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r ${e.color} rounded-full`})]},e.id)})})}),N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[N.jsx("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl p-6 border border-slate-700/50",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:N.jsx(se,{className:"text-blue-600 text-xl"})})}),N.jsxs("div",{className:"ml-4",children:[N.jsx("p",{className:"text-sm font-medium text-slate-400",children:"Celkový počet predajov"}),N.jsx("p",{className:"text-2xl font-bold text-white",children:t.length})]})]})}),N.jsx("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl p-6 border border-slate-700/50",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:N.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})})}),N.jsxs("div",{className:"ml-4",children:[N.jsx("p",{className:"text-sm font-medium text-slate-400",children:"Celkové tržby"}),N.jsxs("p",{className:"text-2xl font-bold text-white",children:[j.toFixed(2)," €"]})]})]})}),N.jsx("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl p-6 border border-slate-700/50",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:N.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),N.jsxs("div",{className:"ml-4",children:[N.jsx("p",{className:"text-sm font-medium text-slate-400",children:"Dokončené predaje"}),N.jsx("p",{className:"text-2xl font-bold text-white",children:v})]})]})})]}),N.jsxs("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl border border-slate-700/50 shadow-2xl overflow-hidden",children:[N.jsx("div",{className:"px-6 py-4 border-b border-slate-700/50 bg-slate-800/50",children:N.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[N.jsxs("div",{children:[N.jsxs("h3",{className:"text-xl font-bold text-white",children:["Predaje (",f.length,")"]}),N.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Správa a prehľad predajov"})]}),N.jsx("div",{className:"flex items-center space-x-3",children:N.jsxs("div",{className:"relative",children:[N.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 text-sm"}),N.jsx("input",{type:"text",placeholder:"Vyhľadať predaje...",value:d,onChange:e=>x(e.target.value),className:"pl-10 pr-4 py-2 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-green-500/50 focus:border-transparent transition-all duration-200"})]})})]})}),N.jsxs("div",{className:"overflow-x-auto",children:[N.jsxs("table",{className:"min-w-full divide-y divide-slate-700/50",children:[N.jsx("thead",{className:"bg-slate-800/50",children:N.jsxs("tr",{children:[N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Externé ID"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Produkt"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Veľkosť"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Cena"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Payout"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Používateľ"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Status"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Dátum"}),N.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-300 uppercase tracking-wider",children:"Akcie"})]})}),N.jsx("tbody",{className:"divide-y divide-slate-700/30",children:f.map(e=>{return N.jsxs("tr",{className:"hover:bg-slate-700/20 transition-colors",children:[N.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N.jsx("span",{className:"text-slate-300 text-sm font-mono",children:e.external_id||"N/A"})}),N.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"h-16 w-16 flex-shrink-0 overflow-hidden rounded-xl border border-slate-600 bg-white shadow-sm",children:N.jsx("img",{className:"h-full w-full object-contain p-2",src:e.image_url||"/default-image.png",alt:e.name,onError:e=>{e.target.src="/default-image.png"}})}),N.jsxs("div",{className:"ml-4",children:[N.jsx("div",{className:"text-sm font-semibold text-white",children:e.name}),N.jsxs("div",{className:"text-xs text-slate-400",children:["SKU: ",e.sku||"N/A"]})]})]})}),N.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-slate-700 text-slate-200",children:e.size})}),N.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-white",children:[e.price," €"]}),N.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-green-400",children:[e.payout.toFixed(2)," €"]}),N.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-300",children:e.user_email}),N.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N.jsx(be,{status:e.status})}),N.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-300",children:N.jsxs("div",{className:"flex items-center",children:[N.jsx("svg",{className:"w-4 h-4 text-slate-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3a4 4 0 118 0v4m-4 6v6m-4-6h8m-8 0V9a2 2 0 012-2h4a2 2 0 012 2v2"})}),(s=e.created_at,new Date(s).toLocaleDateString("sk-SK",{day:"2-digit",month:"2-digit",year:"numeric"}))]})}),N.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N.jsxs("button",{onClick:()=>p(e),className:"inline-flex items-center px-3 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white text-sm font-semibold rounded-xl hover:from-green-700 hover:to-emerald-700 transition-all duration-200 shadow-sm",children:[N.jsx(ce,{className:"mr-2"}),"Upraviť"]})})]},e.id);var s})})]}),0===f.length&&N.jsxs("div",{className:"text-center py-12",children:[N.jsx("div",{className:"w-16 h-16 bg-slate-700/30 rounded-2xl flex items-center justify-center mx-auto mb-4",children:N.jsx(se,{className:"text-slate-400 text-2xl"})}),N.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Žiadne predaje"}),N.jsx("p",{className:"text-slate-400",children:d?"Nenašli sa žiadne predaje pre váš vyhľadávací výraz":"Zatiaľ nie sú žiadne predaje"})]})]})]}),u&&N.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:N.jsxs("div",{className:"bg-slate-800 p-6 rounded-2xl shadow-2xl max-w-2xl w-full border border-slate-600 max-h-[90vh] overflow-y-auto",children:[N.jsxs("div",{className:"flex items-center justify-between mb-6",children:[N.jsx("h2",{className:"text-xl text-white font-semibold",children:"Správa statusu predaja"}),N.jsx("button",{onClick:()=>p(null),className:"text-slate-400 hover:text-white",children:N.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),N.jsx("div",{className:"bg-slate-700/50 rounded-xl p-4 mb-6",children:N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx("img",{src:u.image_url||"/default-image.png",alt:u.name,className:"h-16 w-16 rounded-lg object-cover"}),N.jsxs("div",{children:[N.jsx("h3",{className:"text-white font-semibold text-lg",children:u.name}),N.jsxs("p",{className:"text-slate-300",children:["Veľkosť: ",u.size]}),N.jsxs("p",{className:"text-slate-300",children:["Cena: ",u.price," €"]}),N.jsxs("p",{className:"text-slate-300",children:["Používateľ: ",u.user_email]}),N.jsxs("p",{className:"text-slate-300",children:["Externé ID: ",u.external_id||"N/A"]})]})]})}),N.jsx(ke,{saleId:u.id,currentStatus:u.status,currentExternalId:u.external_id,onStatusUpdate:e=>{p({...u,status:e}),b()},onExternalIdUpdate:e=>{p({...u,external_id:e}),b()},onClose:()=>p(null)})]})})]})]})}function Ce(){const s=r(),[t,a]=e.useState(null),[i,n]=e.useState(!0),[c,o]=e.useState(!1),[d,x]=e.useState(null),[m,h]=e.useState(null),[u,p]=e.useState(""),[b,f]=e.useState(""),[j,v]=e.useState(!1),g=e.useCallback(async()=>{try{x(null),j||n(!0);const{data:e,error:s}=await C.from("admin_settings").select("id, fee_percent, fee_fixed").single();if(s)throw s;a(e),p((100*e.fee_percent).toString()),f(e.fee_fixed.toString())}catch(e){console.error("Error loading settings:",e.message),x("Chyba pri načítavaní nastavení: "+e.message)}finally{n(!1),v(!1)}},[j]);return e.useEffect(()=>{g()},[]),i?N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center",children:N.jsxs("div",{className:"text-center",children:[N.jsx("div",{className:"w-12 h-12 border-4 border-slate-600 border-t-gray-500 rounded-full animate-spin mx-auto mb-4"}),N.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Načítavajú sa nastavenia"}),N.jsx("p",{className:"text-sm text-slate-400",children:"Prosím čakajte..."})]})}):N.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[N.jsx("header",{className:"bg-slate-800/50 backdrop-blur-xl border-b border-slate-700/50 sticky top-0 z-50",children:N.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsxs("div",{className:"relative",children:[N.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-gray-600 via-slate-600 to-gray-800 rounded-2xl shadow-lg",children:N.jsx(F,{className:"text-white text-xl"})}),N.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-slate-800 animate-pulse"})]}),N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-gray-400 to-slate-400 bg-clip-text text-transparent",children:"Nastavenia"}),N.jsx("p",{className:"text-sm text-slate-400",children:"Správa systémových nastavení"})]})]}),N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsxs("button",{onClick:async()=>{v(!0),await g()},disabled:j,className:"inline-flex items-center px-4 py-2 bg-slate-700/50 text-slate-300 font-semibold rounded-xl hover:bg-slate-600/50 transition-all duration-200 border border-slate-600/50 backdrop-blur-sm disabled:opacity-50",children:[N.jsx(re,{className:"mr-2 text-sm "+(j?"animate-spin":"")}),j?"Obnovuje sa...":"Refresh"]}),N.jsxs("button",{onClick:async()=>{try{await C.auth.signOut(),window.location.href="/"}catch(e){console.error("Error signing out:",e.message)}},className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-red-600 to-red-700 text-white font-semibold rounded-xl hover:from-red-700 hover:to-red-800 transition-all duration-200 shadow-lg transform hover:scale-105",children:[N.jsx(te,{className:"mr-2 text-sm"}),"Odhlásiť"]})]})]})})}),N.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[d&&N.jsx("div",{className:"mb-6 bg-red-900/20 border border-red-500/30 rounded-xl p-4 backdrop-blur-sm",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx(I,{className:"h-5 w-5 text-red-400"}),N.jsx("p",{className:"ml-3 text-sm text-red-300",children:d})]}),N.jsxs("div",{className:"flex space-x-2",children:[N.jsx("button",{onClick:()=>{x(null),g()},className:"text-red-300 hover:text-red-100 text-sm font-medium",children:"Skúsiť znova"}),N.jsx("button",{onClick:()=>x(null),className:"text-red-400 hover:text-red-300",children:N.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})}),m&&N.jsx("div",{className:"mb-6 bg-green-900/20 border border-green-500/30 rounded-xl p-4 backdrop-blur-sm",children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),N.jsx("p",{className:"ml-3 text-sm text-green-300",children:m})]}),N.jsx("button",{onClick:()=>h(null),className:"text-green-400 hover:text-green-300",children:N.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})}),N.jsx("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl border border-slate-700/50 shadow-2xl mb-8 overflow-hidden",children:N.jsx("div",{className:"flex overflow-x-auto",children:[{id:"overview",label:"Prehľad",icon:H,color:"from-blue-500 to-cyan-500",path:"/admin"},{id:"products",label:"Produkty",icon:ee,color:"from-purple-500 to-violet-500",path:"/admin/products"},{id:"listed-products",label:"Ponuky",icon:W,color:"from-orange-500 to-amber-500",path:"/admin/listed-products"},{id:"sales",label:"Predaje",icon:se,color:"from-green-500 to-emerald-500",path:"/admin/sales"},{id:"users",label:"Užívatelia",icon:de,color:"from-indigo-500 to-blue-500",path:"/admin/users"},{id:"settings",label:"Nastavenia",icon:F,color:"from-gray-500 to-slate-500",path:"/admin/settings"}].map(e=>{const t=s.pathname===e.path;return N.jsxs(l,{to:e.path,className:"relative flex items-center px-6 py-4 font-semibold transition-all duration-300 min-w-max "+(t?"text-white":"text-slate-400 hover:text-white hover:bg-slate-700/30"),children:[t&&N.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${e.color} opacity-20 rounded-lg`}),N.jsx(e.icon,{className:"mr-2 text-sm "+(t?`text-transparent bg-gradient-to-r ${e.color} bg-clip-text`:"")}),N.jsx("span",{className:t?`bg-gradient-to-r ${e.color} bg-clip-text text-transparent font-bold`:"",children:e.label}),t&&N.jsx("div",{className:`absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r ${e.color} rounded-full`})]},e.id)})})}),N.jsxs("div",{className:"bg-slate-800/30 backdrop-blur-xl rounded-2xl border border-slate-700/50 shadow-2xl overflow-hidden",children:[N.jsxs("div",{className:"px-6 py-4 border-b border-slate-700/50 bg-slate-800/50",children:[N.jsx("h3",{className:"text-xl font-bold text-white",children:"Systémové nastavenia"}),N.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Konfigurácia poplatkov a systémových parametrov"})]}),N.jsxs("div",{className:"p-6",children:[N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[N.jsxs("div",{children:[N.jsxs("label",{className:"block text-sm font-semibold text-slate-300 mb-3",children:[N.jsx(G,{className:"inline mr-2"}),"Percentuálny poplatok (%)"]}),N.jsx("input",{type:"number",value:u,onChange:e=>p(e.target.value),className:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-gray-500/50 focus:border-transparent transition-all duration-200",step:"0.1",min:"0",max:"100",placeholder:"20"}),N.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Percentuálny poplatok z predajnej ceny"})]}),N.jsxs("div",{children:[N.jsxs("label",{className:"block text-sm font-semibold text-slate-300 mb-3",children:[N.jsx($,{className:"inline mr-2"}),"Fixný poplatok (€)"]}),N.jsx("input",{type:"number",value:b,onChange:e=>f(e.target.value),className:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-gray-500/50 focus:border-transparent transition-all duration-200",step:"0.01",min:"0",placeholder:"5.00"}),N.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Fixný poplatok za každý predaj"})]})]}),u&&b&&N.jsxs("div",{className:"mt-6 bg-slate-700/30 rounded-xl p-4",children:[N.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-3",children:"Náhľad výpočtu"}),N.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[100,200,500].map(e=>{const s=e*(1-parseFloat(u)/100)-parseFloat(b);return N.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[N.jsxs("div",{className:"text-slate-400",children:["Predajná cena: ",N.jsxs("span",{className:"text-white font-semibold",children:[e," €"]})]}),N.jsxs("div",{className:"text-slate-400",children:["Payout: ",N.jsxs("span",{className:"text-green-400 font-semibold",children:[Math.max(0,s).toFixed(2)," €"]})]})]},e)})})]}),N.jsx("div",{className:"mt-6 flex justify-end",children:N.jsx("button",{onClick:async()=>{try{o(!0),x(null),h(null);const e=parseFloat(u)/100,s=parseFloat(b);if(isNaN(e)||isNaN(s))throw new Error("Neplatné hodnoty poplatkov");if(e<0||e>1)throw new Error("Percentuálny poplatok musí byť medzi 0% a 100%");if(s<0)throw new Error("Fixný poplatok nemôže byť záporný");const{error:a}=await C.from("admin_settings").update({fee_percent:e,fee_fixed:s,updated_at:(new Date).toISOString()}).eq("id",t?.id);if(a)throw a;h("Nastavenia boli úspešne uložené!"),g()}catch(e){console.error("Error saving settings:",e.message),x("Chyba pri ukladaní nastavení: "+e.message)}finally{o(!1)}},disabled:c||!u||!b,className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-gray-600 to-slate-600 text-white font-semibold rounded-xl hover:from-gray-700 hover:to-slate-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg transform hover:scale-105",children:c?N.jsxs(N.Fragment,{children:[N.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Ukladá sa..."]}):N.jsxs(N.Fragment,{children:[N.jsx(Q,{className:"mr-2"}),"Uložiť nastavenia"]})})})]})]})]})]})}const ze=({error:e,resetError:s})=>N.jsx("div",{className:"min-h-screen flex justify-center items-center bg-gray-50",children:N.jsxs("div",{className:"text-center max-w-md mx-auto p-6",children:[N.jsx("div",{className:"text-red-600 mb-4",children:N.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 19.5c-.77.833.192 2.5 1.732 2.5z"})})}),N.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Chyba aplikácie"}),N.jsx("p",{className:"text-gray-600 mb-4",children:"Nastala neočakávaná chyba pri načítavaní aplikácie."}),N.jsx("button",{onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Skúsiť znova"}),N.jsxs("details",{className:"mt-4 text-left",children:[N.jsx("summary",{className:"cursor-pointer text-gray-500 text-sm",children:"Technické detaily"}),N.jsx("pre",{className:"mt-2 p-2 bg-gray-100 rounded text-xs overflow-auto",children:e.message})]})]})});function Se(){const[s,t]=e.useState(null),[a,l]=e.useState(!1),[r,o]=e.useState(!0),[d,x]=e.useState(null),[m,h]=e.useState(null),u=e.useRef({}),p=e.useRef(!1),b=e.useCallback(async e=>{try{if(void 0!==u.current[e])return u.current[e];const{data:s,error:t}=await C.from("admin_users").select("id").eq("id",e).single();if(t&&"PGRST116"!==t.code)return console.warn("Admin check error:",t.message),!1;const a=!!s;return u.current[e]=a,a}catch(s){return console.warn("Error checking admin status:",s.message),!1}},[]),f=e.useCallback(async()=>{if(!p.current)try{p.current=!0,x(null),h(null);const s=C.auth.getUser(),a=new Promise((e,s)=>setTimeout(()=>s(new Error("Auth timeout")),1e4)),{data:{user:r},error:i}=await Promise.race([s,a]);if(i&&"Auth session missing!"!==i.message)return t(null),l(!1),void o(!1);if(t(r),r)try{const e=await b(r.id);l(e)}catch(e){l(!1)}else l(!1),u.current={}}catch(s){s.message.includes("timeout")||s.message.includes("fetch")?(t(null),l(!1)):(x("Chyba pri načítavaní: "+s.message),h(s)),t(null),l(!1)}finally{o(!1),p.current=!1}},[b]);return e.useEffect(()=>{const e=e=>{h(e.error)},s=e=>{h(new Error(e.reason?.message||"Unhandled promise rejection"))};return"undefined"!=typeof window?(window.addEventListener("error",e),window.addEventListener("unhandledrejection",s),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",s)}):()=>{}},[]),e.useEffect(()=>{let e=!0;(async()=>{e&&await f()})();const{data:{subscription:s}}=C.auth.onAuthStateChange(async(s,a)=>{if(e)try{const e=a?.user??null;if(t(e),e)if("SIGNED_IN"===s){u.current={};const s=await b(e.id);l(s)}else{const s=await b(e.id);l(s)}else l(!1),u.current={};x(null)}catch(r){l(!1)}});return()=>{e=!1,s.unsubscribe()}},[f,b]),m?N.jsx(ze,{error:m,resetError:()=>h(null)}):N.jsxs(i,{children:[N.jsx(n,{path:"/",element:s?a?N.jsx(c,{to:"/admin",replace:!0}):N.jsx(c,{to:"/dashboard",replace:!0}):N.jsx("div",{className:"min-h-screen flex justify-center items-center bg-gray-50",children:N.jsxs("div",{className:"w-full max-w-md bg-white p-8 rounded-lg shadow-lg",children:[N.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"Prihlásenie"}),r&&N.jsx("div",{className:"mb-4 text-gray-500 text-center text-sm",children:"Overujem prihlásenie..."}),N.jsx(z,{}),d&&N.jsx("div",{className:"mt-4 p-2 bg-red-100 text-red-800 rounded text-center text-sm",children:d})]})})}),N.jsx(n,{path:"/dashboard",element:s&&!a?N.jsx(he,{isAdmin:a}):N.jsx(c,{to:a?"/admin":"/",replace:!0})}),N.jsx(n,{path:"/profile",element:s?N.jsx(ue,{}):N.jsx(c,{to:"/",replace:!0})}),N.jsx(n,{path:"/sales",element:s?N.jsx(je,{}):N.jsx(c,{to:"/",replace:!0})}),N.jsx(n,{path:"/admin",element:s&&a?N.jsx(ve,{}):N.jsx(c,{to:"/dashboard",replace:!0})}),N.jsx(n,{path:"/admin/products",element:s&&a?N.jsx(ge,{}):N.jsx(c,{to:"/dashboard",replace:!0})}),N.jsx(n,{path:"/admin/users",element:s&&a?N.jsx(Ne,{}):N.jsx(c,{to:"/dashboard",replace:!0})}),N.jsx(n,{path:"/admin/listed-products",element:s&&a?N.jsx(we,{}):N.jsx(c,{to:"/dashboard",replace:!0})}),N.jsx(n,{path:"/admin/sales",element:s&&a?N.jsx(_e,{}):N.jsx(c,{to:"/dashboard",replace:!0})}),N.jsx(n,{path:"/admin/settings",element:s&&a?N.jsx(Ce,{}):N.jsx(c,{to:"/dashboard",replace:!0})})]})}class Pe extends t.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){console.error("Application error:",e,s)}componentDidMount(){void 0===window.global&&(window.global=window),void 0===window.process&&(window.process={env:{}})}render(){return this.state.hasError?N.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column",padding:"20px",textAlign:"center"},children:[N.jsx("h1",{style:{color:"#ef4444",marginBottom:"16px"},children:"Chyba aplikácie"}),N.jsx("p",{style:{color:"#64748b",marginBottom:"16px"},children:"Nastala neočakávaná chyba. Skúste obnoviť stránku."}),N.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Obnoviť stránku"}),this.state.error&&N.jsxs("details",{style:{marginTop:"20px",textAlign:"left"},children:[N.jsx("summary",{style:{cursor:"pointer",color:"#64748b"},children:"Technické detaily"}),N.jsx("pre",{style:{marginTop:"10px",padding:"10px",backgroundColor:"#f1f5f9",borderRadius:"4px",fontSize:"12px",overflow:"auto"},children:this.state.error.toString()})]})]}):this.props.children}}const Le=document.getElementById("root");if(!Le)throw new Error("Root element not found");w.createRoot(Le).render(N.jsx(t.StrictMode,{children:N.jsx(Pe,{children:N.jsx(o,{children:N.jsx(Se,{})})})}));
